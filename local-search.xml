<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>win7é…ç½® V16ç‰ˆæœ¬node</title>
    <link href="/2024/02/19/config/config/"/>
    <url>/2024/02/19/config/config/</url>
    
    <content type="html"><![CDATA[<h1 id="win7ç¯å¢ƒä¸Šä¸‹è½½nodeæºç "><a href="#win7ç¯å¢ƒä¸Šä¸‹è½½nodeæºç " class="headerlink" title="win7ç¯å¢ƒä¸Šä¸‹è½½nodeæºç "></a>win7ç¯å¢ƒä¸Šä¸‹è½½nodeæºç </h1><h1 id="è§£å‹NODEç‰ˆæœ¬-åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®-node-è·¯å¾„"><a href="#è§£å‹NODEç‰ˆæœ¬-åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®-node-è·¯å¾„" class="headerlink" title="è§£å‹NODEç‰ˆæœ¬ åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½® node è·¯å¾„"></a>è§£å‹NODEç‰ˆæœ¬ åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½® node è·¯å¾„</h1><p><img src="/img/config/node-path.png"></p><h1 id="é…ç½®NODE-SKIP-PLATFORM-CHECK-ç¯å¢ƒå˜é‡ä¸º1"><a href="#é…ç½®NODE-SKIP-PLATFORM-CHECK-ç¯å¢ƒå˜é‡ä¸º1" class="headerlink" title="é…ç½®NODE_SKIP_PLATFORM_CHECK ç¯å¢ƒå˜é‡ä¸º1"></a>é…ç½®NODE_SKIP_PLATFORM_CHECK ç¯å¢ƒå˜é‡ä¸º1</h1><p><img src="/img/config/node-check.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>wasmç¼–è¯‘å¤„ç†</title>
    <link href="/2024/01/14/wasm-md/"/>
    <url>/2024/01/14/wasm-md/</url>
    
    <content type="html"><![CDATA[<h2 id="mac-ç«¯ç¼–è¯‘-wasm"><a href="#mac-ç«¯ç¼–è¯‘-wasm" class="headerlink" title="mac ç«¯ç¼–è¯‘ wasm"></a>mac ç«¯ç¼–è¯‘ wasm</h2><ol><li>ä¸‹è½½Emscriptenä»£ç åˆ°æœ¬åœ°<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Get the emsdk repo    </span><br>git <span class="hljs-built_in">clone</span> https://github.com/emscripten-core/emsdk.git<br><br><span class="hljs-comment"># Enter that directory    </span><br><span class="hljs-built_in">cd</span> emsdk<br></code></pre></td></tr></table></figure></li><li>å®‰è£…æœ€æ–°çš„å·¥å…·<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-comment"># Download and install the latest SDK tools.    </span><br>./emsdk install latest<br><br><span class="hljs-comment"># Make the &quot;latest&quot; SDK &quot;active&quot; for the current user. (writes .emscripten file)    </span><br>./emsdk activate latest<br><br><span class="hljs-comment"># Activate PATH and other environment variables in the current terminal    </span><br><span class="hljs-built_in">source</span> ./emsdk_env.sh <br></code></pre></td></tr></table></figure>b. ä¸€ä¸ªå¯ä»¥è¿è¡ŒWebAssemblyçš„æµè§ˆå™¨<br>ç›®å‰å„å¤§ä¸»æµæµè§ˆå™¨éƒ½å·²ç»æ”¯æŒwebassemblyï¼ŒåŒ…æ‹¬ï¼šchromeã€edgeã€safariã€firefoxã€operaã€‚é™¤äº†ï¼Œemmmï¼ŒIEã€‚åªéœ€è¦å°†æµè§ˆå™¨å‡çº§åˆ°æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¼€å¯ç›¸åº”çš„é…ç½®å³å¯ã€‚</li></ol><p>c. ä¸€ä¸ªç®€å•çš„Cè¯­è¨€ç¨‹åº<br>è¿™é‡Œä½¿ç”¨Cè¯­è¨€ç¼–å†™ä¸€ä¸ªç®€å•çš„helloworldç¨‹åºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><br>int <span class="hljs-function"><span class="hljs-title">main</span></span>() &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello, world!&quot;</span>);<br>    <span class="hljs-built_in">return</span> 0;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>ç¼–è¯‘Cä»£ç åˆ°webassembly<br>ä½¿ç”¨emscriptenå·¥å…·å°†Cä»£ç ç¼–è¯‘ä¸ºWebAssemblyã€‚ç¼–è¯‘å®Œæˆåï¼Œä¼šå¾—åˆ°ä¸‰ä¸ªæ–°æ–‡ä»¶ï¼Œåˆ†åˆ«ä»¥.htmlï¼Œ.jså’Œ.wasmç»“å°¾ã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Compile c file to wasm file</span><br>emcc hello.c -s WASM=1 -s FORCE_FILESYSTEM=1 -s EXIT_RUNTIME=1 -o hello.html<br></code></pre></td></tr></table></figure></li><li>è¿è¡Œ<br>å¯åŠ¨ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œä½¿ç”¨æµè§ˆå™¨æ‰“å¼€localhost:8080&#x2F;hello.htmlæ–‡ä»¶ï¼Œçœ‹åˆ°æ§åˆ¶å°æ˜¾ç¤ºâ€Hello, world!â€ï¼Œè¡¨ç¤ºæ„å»ºæˆåŠŸã€‚</li></ol><p>å¯åŠ¨æ–‡ä»¶æœåŠ¡å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Start file server    </span><br>emrun --no_browser --port 8080 .<br></code></pre></td></tr></table></figure><ol start="2"><li>æµè§ˆå™¨æ‰“å¼€<a href="http://localhost:8080/hello.html">http://localhost:8080/hello.html</a></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>wasm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœç´¢æ’å…¥ä½ç½®</title>
    <link href="/2023/12/05/algorithm/code-35/"/>
    <url>/2023/12/05/algorithm/code-35/</url>
    
    <content type="html"><![CDATA[<h1 id="åŠ›æ‰£"><a href="#åŠ›æ‰£" class="headerlink" title="åŠ›æ‰£"></a><a href="https://leetcode.cn/problems/search-insert-position/description/">åŠ›æ‰£</a></h1><p>è¯·å¿…é¡»ä½¿ç”¨æ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•ã€‚<br>ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚</p><p>è¯·å¿…é¡»ä½¿ç”¨æ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">const</span> searchInsert = <span class="hljs-keyword">function</span>(<span class="hljs-params">nums, target</span>) &#123;<br>    <span class="hljs-comment">//  åŒºé—´å·¦å¼€å³é—­ [left, right]</span><br>    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">let</span> right = nums.<span class="hljs-property">length</span> - <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span>(left &lt;= right) &#123;<br>        <span class="hljs-keyword">let</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((left + right) / <span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">if</span>(nums[mid] === target) &#123;<br>            <span class="hljs-keyword">return</span> mid<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &lt; target) &#123;<br>            left = mid + <span class="hljs-number">1</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            right = mid - <span class="hljs-number">1</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> right + <span class="hljs-number">1</span><br>&#125;;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>algorithm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vim å¸¸ç”¨å‘½ä»¤</title>
    <link href="/2023/12/04/vim/vim-code/"/>
    <url>/2023/12/04/vim/vim-code/</url>
    
    <content type="html"><![CDATA[<h1 id="vim-æ˜¾ç¤ºè¡Œå·"><a href="#vim-æ˜¾ç¤ºè¡Œå·" class="headerlink" title="vim æ˜¾ç¤ºè¡Œå·"></a>vim æ˜¾ç¤ºè¡Œå·</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è®¾ç½®è¡Œå·å±•ç¤º</span><br><span class="hljs-built_in">set</span> number<br><span class="hljs-comment"># å–æ¶ˆè¡Œå·å±•ç¤º</span><br><span class="hljs-built_in">set</span> nonumber<br></code></pre></td></tr></table></figure><p>ï½œ æ¯æ¬¡éƒ½æ˜¾ç¤ºè¡Œå· å¯ä»¥é€šè¿‡ç¼–è¾‘ vimrc</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim ~/.vimrc<br><span class="hljs-built_in">set</span> number<br></code></pre></td></tr></table></figure><h1 id="vim-æ ¼å¼åŒ–æ–‡ä»¶"><a href="#vim-æ ¼å¼åŒ–æ–‡ä»¶" class="headerlink" title="vim æ ¼å¼åŒ–æ–‡ä»¶"></a>vim æ ¼å¼åŒ–æ–‡ä»¶</h1><p>åœ¨Vimä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ ¼å¼åŒ–æ–‡ä»¶ï¼š<br>é¦–å…ˆï¼Œè¿›å…¥Vimç¼–è¾‘å™¨å¹¶æ‰“å¼€ä½ è¦æ ¼å¼åŒ–çš„æ–‡ä»¶ã€‚</p><ol><li>ç¡®ä¿ä½ å¤„äºæ­£å¸¸æ¨¡å¼ï¼ˆæŒ‰ä¸‹Escé”®ï¼‰ã€‚</li><li>ä½¿ç”¨ggå‘½ä»¤å°†å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶çš„å¼€å¤´ã€‚</li><li>è¾“å…¥&#x3D;Gå‘½ä»¤ï¼Œå®ƒä¼šè‡ªåŠ¨ç¼©è¿›æ•´ä¸ªæ–‡ä»¶ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">&gt; gg<br>&gt; =G<br></code></pre></td></tr></table></figure><p>| å¦‚æœä½ åªæƒ³æ ¼å¼åŒ–é€‰å®šçš„ä»£ç å—ï¼Œå¯ä»¥ä½¿ç”¨vå‘½ä»¤è¿›å…¥å¯è§†æ¨¡å¼ï¼Œç„¶åä½¿ç”¨ç§»åŠ¨å‘½ä»¤é€‰æ‹©ä»£ç å—ï¼Œæœ€åè¾“å…¥&#x3D;å‘½ä»¤è¿›è¡Œç¼©è¿›ã€‚</p><h1 id="vim-åˆ é™¤æŒ‡å®šè¡Œ"><a href="#vim-åˆ é™¤æŒ‡å®šè¡Œ" class="headerlink" title="vim åˆ é™¤æŒ‡å®šè¡Œ"></a>vim åˆ é™¤æŒ‡å®šè¡Œ</h1><ol><li>è¦åˆ é™¤å½“å‰è¡Œï¼Œè¯·æŒ‰ä¸‹ ddã€‚</li><li>è¦åˆ é™¤ç‰¹å®šè¡Œï¼Œè¯·æŒ‰ä¸‹ :ndï¼Œå…¶ä¸­ n ä»£è¡¨è¡Œå·ã€‚ä¾‹å¦‚ï¼Œè¦åˆ é™¤ç¬¬ 5 è¡Œï¼Œæ‚¨å¯ä»¥è¾“å…¥ :5dã€‚</li><li>è¦åˆ é™¤å¤šè¡Œï¼Œè¯·ä½¿ç”¨ :[start],[end]d çš„è¯­æ³•ã€‚ä¾‹å¦‚ï¼Œè¦åˆ é™¤ç¬¬ 5 è¡Œåˆ°ç¬¬ 10 è¡Œï¼Œæ‚¨å¯ä»¥è¾“å…¥ :5,10dã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ é™¤å½“å‰è¡Œ</span><br><span class="hljs-built_in">dd</span><br><span class="hljs-comment"># åˆ é™¤ç‰¹å®šè¡Œ</span><br>:5d<br><span class="hljs-comment">#åˆ é™¤èŒƒå›´</span><br>:5,10d<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¿»è½¬å­—ç¬¦ä¸²</title>
    <link href="/2023/11/28/algorithm/flip%20the%20string/"/>
    <url>/2023/11/28/algorithm/flip%20the%20string/</url>
    
    <content type="html"><![CDATA[<h1 id="åŠ›æ‰£344"><a href="#åŠ›æ‰£344" class="headerlink" title="åŠ›æ‰£344"></a><a href="https://leetcode.cn/problems/reverse-string/">åŠ›æ‰£344</a></h1><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²åè½¬è¿‡æ¥ã€‚è¾“å…¥å­—ç¬¦ä¸²ä»¥å­—ç¬¦æ•°ç»„ s çš„å½¢å¼ç»™å‡ºã€‚</p><p>ä¸è¦ç»™å¦å¤–çš„æ•°ç»„åˆ†é…é¢å¤–çš„ç©ºé—´ï¼Œä½ å¿…é¡»åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„ã€ä½¿ç”¨ O(1) çš„é¢å¤–ç©ºé—´è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šs &#x3D; [â€œhâ€,â€eâ€,â€lâ€,â€lâ€,â€oâ€]<br>è¾“å‡ºï¼š[â€œoâ€,â€lâ€,â€lâ€,â€eâ€,â€hâ€]<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šs &#x3D; [â€œHâ€,â€aâ€,â€nâ€,â€nâ€,â€aâ€,â€hâ€]<br>è¾“å‡ºï¼š[â€œhâ€,â€aâ€,â€nâ€,â€nâ€,â€aâ€,â€Hâ€]</p><p>è§£é¢˜æ€è·¯</p><ul><li>ä¸ä½¿ç”¨ç©ºé—´ï¼Œå› æ­¤éœ€è¦åŸæ•°ç»„æ“ä½œã€‚</li><li>å­—ç¬¦ä¸²éœ€è¦ç¿»è½¬ï¼Œå› æ­¤éœ€è¦é¦–ä½ä¸¤æ¡ç›¸äº’äº¤æ¢ï¼Œ éœ€è¦åŒæŒ‡é’ˆå¤„ç†<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> reverseString = <span class="hljs-keyword">function</span>(<span class="hljs-params">s</span>) &#123;<br> <span class="hljs-comment">// é¦–æŒ‡é’ˆ   </span><br> <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>;<br> <span class="hljs-comment">// å°¾æŒ‡é’ˆ</span><br> <span class="hljs-keyword">let</span> right = s.<span class="hljs-property">length</span>  -<span class="hljs-number">1</span> <br> <span class="hljs-keyword">while</span>(left &lt; right) &#123;<br>    <span class="hljs-comment">// äº¤æ¢å€¼</span><br>     [s[left], s[right]] = [s[right], s[left]]<br>     left++;<br>     right--;<br> &#125;<br> <span class="hljs-keyword">return</span> s<br>&#125;;<br><br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>algorithm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>electron å¸¸è§é—®é¢˜&amp;&amp;è§£å†³æ–¹æ¡ˆ</title>
    <link href="/2023/10/25/electron/electron-question/"/>
    <url>/2023/10/25/electron/electron-question/</url>
    
    <content type="html"><![CDATA[<h1 id="æ‰©å±•electron-vue-devtools"><a href="#æ‰©å±•electron-vue-devtools" class="headerlink" title="æ‰©å±•electron vue-devtools"></a>æ‰©å±•electron vue-devtools</h1><p><a href="https://www.electronjs.org/zh/docs/latest/tutorial/devtools-extension">dev-tool å®˜æ–¹æŒ‡å¯¼æ–‡æ¡£</a></p><h2 id="å¼€å¯devTool"><a href="#å¼€å¯devTool" class="headerlink" title="å¼€å¯devTool"></a>å¼€å¯devTool</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// create windown è°ƒç”¨</span><br><span class="hljs-title function_">createWindow</span>(<span class="hljs-params"></span>) &#123;<br>    ....<br>    mainWindow.<span class="hljs-title function_">loadURL</span>(<span class="hljs-variable constant_">VITE_DEV_SERVER_URL</span>);<br>    mainWindow.<span class="hljs-property">webContents</span>.<span class="hljs-title function_">openDevTools</span>();<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="åŠ è½½vue-devtool"><a href="#åŠ è½½vue-devtool" class="headerlink" title="åŠ è½½vue-devtool"></a>åŠ è½½vue-devtool</h2><ol><li>åœ¨ Google Chrome ä¸­å®‰è£…æ‰©å±•(ä¹Ÿå¯ä»¥ä¸‹è½½æºç ç¦»çº¿ç¼–è¯‘)</li><li>æ‰“å¼€chrome:&#x2F;&#x2F;extensions è·å–æ‰©å±•hashå€¼ï¼Œ</li><li>æ‰¾åˆ° Chrome æ‰©å±•ç¨‹åºçš„å­˜æ”¾ç›®å½•ï¼š<br>åœ¨ï¼·indows ä¸‹ä¸º %LOCALAPPDATA%\Google\Chrome\User Data\Default\Extensions;<br>åœ¨ Linuxä¸‹ä¸ºï¼š<br><del>&#x2F;.config&#x2F;google-chrome&#x2F;Default&#x2F;Extensions&#x2F;<br>~&#x2F;.config&#x2F;google-chrome-beta&#x2F;Default&#x2F;Extensions&#x2F;<br>~&#x2F;.config&#x2F;google-chrome-canary&#x2F;Default&#x2F;Extensions&#x2F;<br>~&#x2F;.config&#x2F;chromium&#x2F;Default&#x2F;Extensions&#x2F;<br>åœ¨ macOSä¸‹ä¸º</del>&#x2F;Library&#x2F;Application Support&#x2F;Google&#x2F;Chrome&#x2F;Default&#x2F;Extensionsã€‚</li><li>å°†æ‰©å±•çš„ä½ç½®ä¼ é€’ç»™ ses.loadExtension API<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// username ç”µè„‘ç”¨æˆ·å</span><br><span class="hljs-comment">// extendsionId </span><br><span class="hljs-keyword">const</span> vueDevToolsPath = <span class="hljs-string">`C:\\Users\\<span class="hljs-subst">$&#123;username&#125;</span>\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Extensions\\<span class="hljs-subst">$&#123;extendsionId&#125;</span>\\<span class="hljs-subst">$&#123;extendsionVersion&#125;</span>`</span><br>app.<span class="hljs-title function_">whenReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">VITE_DEV_SERVER_URL</span>) &#123;<br>      <span class="hljs-comment">// åŠ è½½vue3 ä»£ç è°ƒè¯•å·¥å…·</span><br>      <span class="hljs-keyword">await</span> session.<span class="hljs-property">defaultSession</span>.<span class="hljs-title function_">loadExtension</span>(vueDevToolsPath);<br>    &#125;<br>    <span class="hljs-comment">// åˆ›å»ºçª—å£</span><br>    <span class="hljs-title function_">createWindow</span>();<br>  &#125;);<br></code></pre></td></tr></table></figure><img src="/img/electron/electron-devtool.png"></li></ol><h1 id="Electron-å¯åŠ¨åç«¯æœåŠ¡"><a href="#Electron-å¯åŠ¨åç«¯æœåŠ¡" class="headerlink" title="Electron å¯åŠ¨åç«¯æœåŠ¡"></a>Electron å¯åŠ¨åç«¯æœåŠ¡</h1><h2 id="é€šè¿‡execFile-å¯åŠ¨å¯æ‰§è¡Œçš„exeæ–‡ä»¶"><a href="#é€šè¿‡execFile-å¯åŠ¨å¯æ‰§è¡Œçš„exeæ–‡ä»¶" class="headerlink" title="é€šè¿‡execFile å¯åŠ¨å¯æ‰§è¡Œçš„exeæ–‡ä»¶"></a>é€šè¿‡execFile å¯åŠ¨å¯æ‰§è¡Œçš„exeæ–‡ä»¶</h2><p>ä¾‹å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªapp.exe æ”¾å…¥é¡¹ç›®çš„æ ¹ç›®å½• resourcesæ–‡ä»¶ä¸‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123;execFile&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;â€˜child_processâ€™&#x27;</span><br><span class="hljs-keyword">const</span> backend = path.<span class="hljs-title function_">join</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">&#x27;/resources/app.exe&#x27;</span>)<br>cosnt childProcess = <span class="hljs-title function_">execfile</span>(<br> backend,<br> &#123;<br>  <span class="hljs-attr">windowsHide</span>: <span class="hljs-literal">true</span>,<br> &#125;,<br> <span class="hljs-function">(<span class="hljs-params">err, stdout, stderr</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (err) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);<br>  &#125;<br>  <span class="hljs-keyword">if</span> (stdout) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stdout);<br>  &#125;<br>  <span class="hljs-keyword">if</span> (stderr) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stderr);<br>  &#125;<br> &#125;<br>)<br></code></pre></td></tr></table></figure><h2 id="electron-é€€å‡º"><a href="#electron-é€€å‡º" class="headerlink" title="electron é€€å‡º"></a>electron é€€å‡º</h2><p>electron åº”ç”¨é€€å‡ºåå¯æ‰§è¡Œå‘½ä»¤é€€å‡ºå­ç¨‹åº<br>ç¨‹åºæ‰§è¡Œå† <strong>app.quit()</strong> ä¹‹å‰æ‰§è¡Œ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; exec &#125;  <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;child_process&#x27;</span>;<br><span class="hljs-title function_">exec</span>(<span class="hljs-string">&#x27;taskkill /f /t /im app.exe&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err, stdout, stderr</span>) =&gt;</span> &#123;<br> <span class="hljs-keyword">if</span> (err) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)<br> <span class="hljs-keyword">return</span>;<br> &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h1 id="åº”ç”¨å•å¼€"><a href="#åº”ç”¨å•å¼€" class="headerlink" title="åº”ç”¨å•å¼€"></a>åº”ç”¨å•å¼€</h1><p>å¯é€šè¿‡ requestSingleInstanceLock() æ–¹æ¡ˆæ·»åŠ åº”ç”¨å•å¼€å¤„ç†<br>requestSingleInstanceLock API å¯ä»¥å‚è€ƒ<a href="https://www.electronjs.org/zh/docs/latest/api/app#requestSingleInstanceLock">å®˜ç½‘è§£é‡Š</a></p><ul><li>é€šè¿‡requestSingleInstanceLock è·å–å•ä¾‹</li><li>æ ¹æ® å•ä¾‹é”çŠ¶æ€ åˆ¤æ–­æ˜¯å¦å±•ç¤ºåº”ç”¨è¿˜æ˜¯å…³é—­åº”ç”¨<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> appInstanceLock = app.<span class="hljs-title function_">requestSingleInstanceLock</span>();<br><span class="hljs-keyword">if</span> (!appInstanceLock) &#123;<br>  app.<span class="hljs-title function_">quit</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-comment">// å¼€å¯APP</span><br>  <span class="hljs-title function_">loadWinApp</span>();<br>&#125;<br><br>app.<span class="hljs-title function_">whenReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">()=&gt;</span> &#123;<br>  ....<br>  <span class="hljs-comment">// åªå…è®¸æ‰“å¼€ä¸€ä¸ªçª—å£</span><br><br>  app.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;second-instance&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    win!.<span class="hljs-title function_">show</span>();<br>  &#125;);<br>&#125;)<br></code></pre></td></tr></table></figure></li></ul><h1 id="win7-æ¡Œé¢ç«¯æ”¯æŒ"><a href="#win7-æ¡Œé¢ç«¯æ”¯æŒ" class="headerlink" title="win7 æ¡Œé¢ç«¯æ”¯æŒ"></a>win7 æ¡Œé¢ç«¯æ”¯æŒ</h1><p>electron23.0 ä¹‹åä¸å†æ”¯æŒwin7&amp;&amp;win8 ç­‰ï¼Œè¯¦æƒ…è§<a href="https://github.com/electron/electron/tree/main">å®˜æ–¹æ–‡æ¡£</a><br>å¦‚æœç¨‹åºéœ€è¦æ”¯æŒå¯ä»¥å°†electron é™çº§ç‰ˆæœ¬</p><ul><li>electron 22.0</li><li>electron-builder 22.10.5</li></ul><h1 id="win7-æ‰“åŒ…åç¨‹åºå®‰è£…æç¤ºå¯åŠ¨é”™è¯¯"><a href="#win7-æ‰“åŒ…åç¨‹åºå®‰è£…æç¤ºå¯åŠ¨é”™è¯¯" class="headerlink" title="win7 æ‰“åŒ…åç¨‹åºå®‰è£…æç¤ºå¯åŠ¨é”™è¯¯"></a>win7 æ‰“åŒ…åç¨‹åºå®‰è£…æç¤ºå¯åŠ¨é”™è¯¯</h1><p> éœ€è¦å®‰è£…ä¾å¾®è½¯å¸¸ç”¨çš„ä¾èµ–åº“<br> <a href="/resource/%E5%BE%AE%E8%BD%AF%E5%B8%B8%E7%94%A8%E8%BF%90%E8%A1%8C%E5%BA%93%E5%90%88%E9%9B%86_2023.03.03.exe">å¾®è½¯å¸¸ç”¨è¿è¡Œåº“åˆé›†</a></p><h1 id="å®¢æˆ·ç«¯-getAppPath-å«æœ‰-app-asar-é—®é¢˜å¤„ç†"><a href="#å®¢æˆ·ç«¯-getAppPath-å«æœ‰-app-asar-é—®é¢˜å¤„ç†" class="headerlink" title="å®¢æˆ·ç«¯ getAppPath å«æœ‰ app.asar é—®é¢˜å¤„ç†"></a>å®¢æˆ·ç«¯ getAppPath å«æœ‰ app.asar é—®é¢˜å¤„ç†</h1><p> getAppPath()å¯ä»¥è·å–åˆ°ç¨‹åºè¿è¡Œè·Ÿç›®å½•ï¼Œæ‰“åŒ…åä¼šæœ‰app.asar<br> å½“å‰å¯ä»¥ç›´æ¥é€šè¿‡replace å‡½æ•°æ›¿æ¢ app.asar<br> ä¾‹å¦‚ï¼š<br> <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> appRootPath = app.<span class="hljs-title function_">getAppPath</span>().<span class="hljs-title function_">repace</span>(<span class="hljs-string">&#x27;app.asar&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br></code></pre></td></tr></table></figure></p><h1 id="vite-vue3-é¡µé¢ä¸­å›¾ç‰‡æ˜¾ç¤ºé”™è¯¯é—®é¢˜å¤„ç†"><a href="#vite-vue3-é¡µé¢ä¸­å›¾ç‰‡æ˜¾ç¤ºé”™è¯¯é—®é¢˜å¤„ç†" class="headerlink" title="vite-vue3 é¡µé¢ä¸­å›¾ç‰‡æ˜¾ç¤ºé”™è¯¯é—®é¢˜å¤„ç†"></a>vite-vue3 é¡µé¢ä¸­å›¾ç‰‡æ˜¾ç¤ºé”™è¯¯é—®é¢˜å¤„ç†</h1><p>å›¾ç‰‡åœ°å€ä¸ºç±»ä¼¼</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> img = <span class="hljs-string">&#x27;/img/test.png&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ¬åœ°å¼€å‘æ—¶é¢„è§ˆæ­£å¸¸electron æ‰“åŒ…çº¿ä¸Šåæ˜¾ç¤ºåœ°å€æ‰¾ä¸åˆ°<br>å¤„ç†æ–¹æ¡ˆå°†å›¾ç‰‡åœ°å€è½¬ä¸ºç»å¯¹åœ°å€è·¯å¾„</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">&#x27;/image/sludge.png&#x27;</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>).<span class="hljs-property">href</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>electron</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­å»º electronå¼€å‘ç¯å¢ƒ</title>
    <link href="/2023/10/17/electron/electron-start/"/>
    <url>/2023/10/17/electron/electron-start/</url>
    
    <content type="html"><![CDATA[<p>#åŸºç¡€é¡¹ç›®æ­å»º</p><h2 id="é€šè¿‡viteè„šæ‰‹æ¶vue3å‰ç«¯é¡¹ç›®"><a href="#é€šè¿‡viteè„šæ‰‹æ¶vue3å‰ç«¯é¡¹ç›®" class="headerlink" title="é€šè¿‡viteè„šæ‰‹æ¶vue3å‰ç«¯é¡¹ç›®"></a>é€šè¿‡viteè„šæ‰‹æ¶vue3å‰ç«¯é¡¹ç›®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm create vite@latest electron-vue -- --template vue-ts<br></code></pre></td></tr></table></figure><h2 id="æ·»åŠ -electron"><a href="#æ·»åŠ -electron" class="headerlink" title="æ·»åŠ  electron"></a>æ·»åŠ  electron</h2><p>å®‰è£…electron &amp;&amp; electron-builder</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i -D electron<br>npm i -D electron-builder<br></code></pre></td></tr></table></figure><p>##å®‰è£…å¼€æºæ’ä»¶ <a href="https://github.com/electron-vite/vite-plugin-electron">vite-plugin-electron</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i -D vite-plugin-electron<br></code></pre></td></tr></table></figure><h2 id="vite-config-ts-å¼•å…¥vite-plugin-electron-æ’ä»¶"><a href="#vite-config-ts-å¼•å…¥vite-plugin-electron-æ’ä»¶" class="headerlink" title="vite-config.ts å¼•å…¥vite-plugin-electron æ’ä»¶"></a>vite-config.ts å¼•å…¥vite-plugin-electron æ’ä»¶</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> electron <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-electron/simple&#x27;</span>;<br><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:path&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">vue</span>(),<br>    <span class="hljs-title function_">electron</span>(&#123;<br>      <span class="hljs-attr">main</span>: &#123;<br>        <span class="hljs-comment">// Shortcut of `build.lib.entry`.</span><br>        <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;electron/main.ts&#x27;</span><br>      &#125;,<br>      <span class="hljs-attr">preload</span>: &#123;<br>        <span class="hljs-comment">// Shortcut of `build.rollupOptions.input`.</span><br>        <span class="hljs-comment">// Preload scripts may contain Web assets, so use the `build.rollupOptions.input` instead `build.lib.entry`.</span><br>        <span class="hljs-attr">input</span>: path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;electron/preload.ts&#x27;</span>)<br>      &#125;,<br>      <span class="hljs-comment">// Ployfill the Electron and Node.js built-in modules for Renderer process.</span><br>      <span class="hljs-comment">// See ğŸ‘‰ https://github.com/electron-vite/vite-plugin-electron-renderer</span><br>      <span class="hljs-attr">renderer</span>: &#123;&#125;<br>    &#125;)<br>  ],<br>  <span class="hljs-attr">server</span>: &#123;<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">9222</span><br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">alias</span>: [<br>      &#123;<br>        <span class="hljs-attr">find</span>: <span class="hljs-string">&#x27;@&#x27;</span>,<br>        <span class="hljs-attr">replacement</span>: <span class="hljs-title function_">pathResolve</span>(<span class="hljs-string">&#x27;src&#x27;</span>)<br>      &#125;<br>    ]<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="æ·»åŠ electron-å…¥å£æ–‡ä»¶"><a href="#æ·»åŠ electron-å…¥å£æ–‡ä»¶" class="headerlink" title="æ·»åŠ electron å…¥å£æ–‡ä»¶"></a>æ·»åŠ electron å…¥å£æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> electron-vue <br><span class="hljs-built_in">mkdir</span> electron<br><span class="hljs-built_in">touch</span> main.ts <span class="hljs-comment"># å…¥å£ä¸»æ–‡ä»¶</span><br><span class="hljs-built_in">touch</span> preload.ts <span class="hljs-comment"># é¢„åŠ è½½è„šæœ¬</span><br></code></pre></td></tr></table></figure><p>main.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; app, <span class="hljs-title class_">BrowserWindow</span>, session &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;electron&#x27;</span>;<br><span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:path&#x27;</span>;<br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">mainWindow</span>: <span class="hljs-title class_">BrowserWindow</span> | <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VITE_DEV_SERVER_URL</span> = process.<span class="hljs-property">env</span>[<span class="hljs-string">&#x27;VITE_DEV_SERVER_URL&#x27;</span>];<br>process.<span class="hljs-property">env</span>.<span class="hljs-property">DIST</span> = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;../dist&#x27;</span>);<br>process.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_PUBLIC</span> = app.<span class="hljs-property">isPackaged</span><br>  ? process.<span class="hljs-property">env</span>.<span class="hljs-property">DIST</span><br>  : path.<span class="hljs-title function_">join</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">DIST</span>, <span class="hljs-string">&#x27;../public&#x27;</span>);<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">createWindow</span>(<span class="hljs-params"></span>) &#123;<br>  mainWindow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>(&#123;<br>    <span class="hljs-comment">// ä¿®æ”¹çª—å£å›¾æ ‡</span><br>    <span class="hljs-attr">icon</span>: path.<span class="hljs-title function_">join</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_PUBLIC</span>, <span class="hljs-string">&#x27;favicon.ico&#x27;</span>),<br>    <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;æµ‹è¯•&#x27;</span>,<br>    <span class="hljs-attr">webPreferences</span>: &#123;<br>      <span class="hljs-attr">preload</span>: path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;preload.js&#x27;</span>)<br>    &#125;<br>  &#125;);<br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">VITE_DEV_SERVER_URL</span>) &#123;<br>    mainWindow.<span class="hljs-title function_">loadURL</span>(<span class="hljs-variable constant_">VITE_DEV_SERVER_URL</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    mainWindow.<span class="hljs-title function_">loadFile</span>(path.<span class="hljs-title function_">join</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">DIST</span>, <span class="hljs-string">&#x27;index.html&#x27;</span>));<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">loadWinApp</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">startBackendServer</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;[info]server is stared&#x27;</span>);<br>  &#125;);<br><br>  <span class="hljs-comment">// Quit when all windows are closed, except on macOS. There, it&#x27;s common</span><br>  <span class="hljs-comment">// for applications and their menu bar to stay active until the user quits</span><br>  <span class="hljs-comment">// explicitly with Cmd + Q.</span><br>  app.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;window-all-closed&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (process.<span class="hljs-property">platform</span> !== <span class="hljs-string">&#x27;darwin&#x27;</span>) &#123;<br>      app.<span class="hljs-title function_">quit</span>();<br>      mainWindow = <span class="hljs-literal">null</span>;<br>    &#125;<br>  &#125;);<br><br>  app.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;activate&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// On OS X it&#x27;s common to re-create a window in the app when the</span><br>    <span class="hljs-comment">// dock icon is clicked and there are no other windows open.</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">BrowserWindow</span>.<span class="hljs-title function_">getAllWindows</span>().<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-title function_">createWindow</span>();<br>    &#125;<br>  &#125;);<br><br>  app.<span class="hljs-title function_">whenReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-comment">// åˆ›å»ºçª—å£</span><br>    <span class="hljs-title function_">createWindow</span>();<br>  &#125;);<br>&#125;<br><span class="hljs-title function_">loadWinApp</span>()<br><br></code></pre></td></tr></table></figure><h2 id="å¯åŠ¨é¡¹ç›®-é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®-é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›® é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›® é¡¹ç›®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm run dev<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>electron</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SVG åæ ‡ç³»</title>
    <link href="/2023/10/09/svg/svg-coordinate-systems/"/>
    <url>/2023/10/09/svg/svg-coordinate-systems/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒèµ„æ–™</p><ul><li>SVGï¼šå¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ | MDN</li><li>Understanding SVG Coordinate Systems and Transformations (Part 1) â€” The viewport, viewBox, and prese</li><li>Coordinate Systems, Transformations and Units â€” SVG 2</li><li>A Guide to SVG Animations (SMIL) | CSS-Tricks</li></ul><p>##Svg ç”»å¸ƒ<br>ç”»å¸ƒ(canvs)æ˜¯ç»˜åˆ¶ SVG å†…å®¹çš„ç©ºé—´æˆ–åŒºåŸŸã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œè¿™å—ç”»å¸ƒåœ¨ä¸¤ä¸ªç»´åº¦(Xè½´, Yè½´)ä¸Šéƒ½æ˜¯æ— é™çš„ã€‚å› æ­¤ï¼ŒSVG å¯ä»¥æ˜¯ä»»æ„å¤§å°ã€‚ç„¶è€Œï¼Œå®ƒæ˜¯ç›¸å¯¹äºç§°ä¸ºè§†å£(viewport)çš„æœ‰é™åŒºåŸŸåœ¨å±å¹•ä¸Šæ¸²æŸ“çš„ã€‚è¶…å‡ºè§†å£è¾¹ç•Œçš„ SVG åŒºåŸŸå°†è¢«å‰ªæ‰å¹¶ä¸”ä¸å¯è§ã€‚<br>è§†å£ï¼ˆviewportï¼‰<br>è§†å£æ˜¯ SVG ç”»å¸ƒçš„å¯è§åŒºåŸŸ. æ•´ä¸ª SVG ç”»å¸ƒæˆ–éƒ¨åˆ†ç”»å¸ƒæ˜¯å¦å¯è§å–å†³äºè¯¥cavasçš„å¤§å°å’ŒpreserveAspectRatio å±æ€§çš„å€¼ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- the viewport will be 800px by 600px --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- SVG content drawn onto the SVG canvas --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨ SVG ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æˆ–ä¸ä½¿ç”¨å•ä½æ ‡è¯†ç¬¦æ¥è®¾ç½®å€¼ã€‚æ— å•ä½å€¼æ®è¯´æ˜¯ä½¿ç”¨ç”¨æˆ·å•ä½åœ¨ç”¨æˆ·ç©ºé—´ä¸­æŒ‡å®šçš„ã€‚å¦‚æœä»¥ç”¨æˆ·å•ä½æŒ‡å®šå€¼ï¼Œåˆ™å‡å®šè¯¥å€¼ç­‰äºç›¸åŒæ•°é‡çš„â€œpxâ€å•ä½ã€‚è¿™æ„å‘³ç€ä¸Šä¾‹ä¸­çš„è§†å£å°†æ¸²æŸ“ä¸º 800px x 600px è§†å£ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å•ä½æŒ‡å®šå€¼ã€‚ SVG ä¸­æ”¯æŒçš„é•¿åº¦å•ä½æ ‡è¯†ç¬¦æœ‰ï¼šemã€exã€pxã€ptã€pcã€cmã€mmã€in å’Œç™¾åˆ†æ¯”ã€‚ä¸€æ—¦è®¾ç½®äº†æœ€å¤–å±‚ SVG å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦ï¼Œæµè§ˆå™¨å°±ä¼šå»ºç«‹ <strong>åˆå§‹è§†å£åæ ‡ç³»(viewport coordinate system)</strong> å’Œ <strong>åˆå§‹ç”¨æˆ·åæ ‡ç³»(initial user coordinate system.)</strong></p><h2 id="åˆå§‹åŒ–åæ ‡ç³»"><a href="#åˆå§‹åŒ–åæ ‡ç³»" class="headerlink" title="åˆå§‹åŒ–åæ ‡ç³»"></a>åˆå§‹åŒ–åæ ‡ç³»</h2><p>åˆå§‹è§†å£åæ ‡ç³»æ˜¯åœ¨è§†å£ä¸Šå»ºç«‹çš„åæ ‡ç³»ï¼ŒåŸç‚¹ä½äºè§†å£å·¦ä¸Šè§’çš„ç‚¹(0, 0)ï¼Œxè½´æ­£æ–¹å‘å‘å³ï¼Œyè½´æ­£æ–¹å‘å‘ä¸‹ï¼Œåˆå§‹åæ ‡ç³»ä¸­çš„ä¸€ä¸ªå•ä½ç­‰äºè§†å£ä¸­çš„ä¸€ä¸ªâ€œåƒç´ â€ã€‚è¿™ä¸ªåæ ‡ç³»ç±»ä¼¼äºç”¨CSSç›’æ¨¡å‹åœ¨HTMLå…ƒç´ ä¸Šå»ºç«‹çš„åæ ‡ç³»ã€‚<br>åˆå§‹ç”¨æˆ·åæ ‡ç³»æ˜¯åœ¨SVGç”»å¸ƒä¸Šå»ºç«‹çš„åæ ‡ç³»ã€‚è¯¥åæ ‡ç³»æœ€åˆä¸è§†å£åæ ‡ç³»ç›¸åŒ - å®ƒçš„åŸç‚¹ä½äºè§†å£çš„å·¦ä¸Šè§’ï¼Œæ­£ x è½´æŒ‡å‘å³ä¾§ï¼Œæ­£ y è½´æŒ‡å‘ä¸‹æ–¹ã€‚ä½¿ç”¨ viewBox å±æ€§ï¼Œå¯ä»¥ä¿®æ”¹åˆå§‹ç”¨æˆ·åæ ‡ç³»ï¼ˆä¹Ÿç§°ä¸ºå½“å‰åæ ‡ç³»æˆ–ä½¿ç”¨ä¸­çš„ç”¨æˆ·ç©ºé—´ï¼‰ï¼Œä½¿å…¶ä¸å†ä¸è§†å£åæ ‡ç³»ç›¸åŒ<br><img src="/img/svg/svg%E5%88%9D%E5%A7%8B%E5%9D%90%E6%A0%87%E7%B3%BB.PNG"></p><h2 id="SVG-åæ ‡ç³»å˜æ¢"><a href="#SVG-åæ ‡ç³»å˜æ¢" class="headerlink" title="SVG åæ ‡ç³»å˜æ¢"></a>SVG åæ ‡ç³»å˜æ¢</h2><p>Transform å±æ€§å€¼<br>Transform å±æ€§ç»™å…ƒç´ æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªå˜æ¢ã€‚å®ƒé‡‡ç”¨ <transform-list> ä½œä¸ºå€¼ï¼Œè¯¥å€¼è¢«å®šä¹‰ä¸ºå˜æ¢å®šä¹‰åˆ—è¡¨ï¼Œè¿™äº›å˜æ¢å®šä¹‰æŒ‰æä¾›çš„é¡ºåºåº”ç”¨ã€‚å„ä¸ªè½¬æ¢å®šä¹‰ç”±ç©ºæ ¼æˆ–é€—å·åˆ†éš”ã€‚å¯¹å…ƒç´ åº”ç”¨è½¬æ¢çš„ç¤ºä¾‹å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>Svg å˜æ¢åŒ…å«ä»¥ä¸‹å‡ ç§ï¼š<strong>æ—‹è½¬ï¼ˆrotationï¼‰__ã€__ç¼©æ”¾ï¼ˆscalingï¼‰__ã€__å¹³ç§»ï¼ˆtranslationï¼‰</strong> å’Œ __å€¾æ–œï¼ˆskewingï¼‰__ã€‚ Transform å±æ€§ä¸­ä½¿ç”¨çš„è½¬æ¢å‡½æ•°çš„å·¥ä½œæ–¹å¼ä¸ Transform å±æ€§ä¸­çš„ CSS è½¬æ¢å‡½æ•°çš„å·¥ä½œæ–¹å¼ç±»ä¼¼ï¼Œåªæ˜¯å®ƒä»¬é‡‡ç”¨ä¸åŒçš„å‚æ•°ã€‚</p><h3 id="çŸ©é˜µ-ï¼ˆMatrixï¼‰"><a href="#çŸ©é˜µ-ï¼ˆMatrixï¼‰" class="headerlink" title="çŸ©é˜µ ï¼ˆMatrixï¼‰"></a>çŸ©é˜µ ï¼ˆMatrixï¼‰</h3><p>ä½ å¯ä»¥é€šè¿‡matrix() æ–¹æ³•æ¥å°†ä¸€ä¸ªæˆ–å¤šä¸ªå˜æ¢åº”ç”¨åˆ°element ä¸Š. Martix è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">matrix</span>(&lt;a&gt; &lt;b&gt; &lt;c&gt; &lt;d&gt; &lt;e&gt; &lt;f&gt;)<br><br>&lt;g transform=<span class="hljs-string">&quot;matrix(1 ,0, 0,1, 0,0)&quot;</span>&gt;&lt;/g&gt;<br></code></pre></td></tr></table></figure><p>é™¤ç‰¹åˆ«ç²¾é€šæ•°å­¦ï¼Œä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨ï¼Œ æ›´å¤šä¿¡æ¯å¯å‚è€ƒ <a href="https://www.w3.org/TR/SVG/coords.html#VectorEffectsCalculation">w3ç½‘å€</a></p><h3 id="å¹³ç§»ï¼ˆTranslationï¼‰"><a href="#å¹³ç§»ï¼ˆTranslationï¼‰" class="headerlink" title="å¹³ç§»ï¼ˆTranslationï¼‰"></a>å¹³ç§»ï¼ˆTranslationï¼‰</h3><p>æƒ³è¦ç§»åŠ¨ä¸€ä¸ªsvg å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ translate() å‡½æ•°ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">translate</span>(&lt;tx&gt; [&lt;ty&gt;])<br></code></pre></td></tr></table></figure><p>translate() æ¥å—ä¸€ä¸ªæˆ–ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æŒ‡å®šæ°´å¹³å’Œå‚ç›´ç§»åŠ¨ã€‚ txè¡¨ç¤ºæ²¿xè½´çš„å¹³ç§»å€¼ï¼› ty è¡¨ç¤ºæ²¿ y è½´çš„å¹³ç§»å€¼ã€‚<br>ty å€¼æ˜¯å¯é€‰çš„ï¼›å¦‚æœçœç•¥ï¼Œåˆ™é»˜è®¤ä¸ºé›¶ã€‚ tx å’Œ ty å€¼å¯ä»¥ä»¥ç©ºæ ¼åˆ†éš”æˆ–ä»¥é€—å·åˆ†éš”ï¼Œå¹¶ä¸”å®ƒä»¬åœ¨å‡½æ•°å†…æ— éœ€ä»»ä½•å•ä½ - å®ƒä»¬é»˜è®¤ä¸ºç”¨æˆ·å½“å‰åæ ‡ç³»å•ä½ã€‚<br>ä»¥ä¸‹ç¤ºä¾‹å°†åœ†å‘å³å¹³ç§» 100 ä¸ªç”¨æˆ·å•ä½ï¼Œå‘ä¸‹å¹³ç§» 300 ä¸ªç”¨æˆ·å•ä½ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;circle cx=<span class="hljs-string">&quot;0&quot;</span> cy=<span class="hljs-string">&quot;0&quot;</span> r=<span class="hljs-string">&quot;100&quot;</span> transform=<span class="hljs-string">&quot;translate(100 300)&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨ translate(100, 300) ï¼ˆå…¶ä¸­å€¼ä»¥é€—å·åˆ†éš”ï¼‰ï¼Œåˆ™ä¸Šé¢çš„ç¤ºä¾‹ä»ç„¶æœ‰æ•ˆã€‚</p><h3 id="ç¼©æ”¾ï¼ˆScalingï¼‰"><a href="#ç¼©æ”¾ï¼ˆScalingï¼‰" class="headerlink" title="ç¼©æ”¾ï¼ˆScalingï¼‰"></a>ç¼©æ”¾ï¼ˆScalingï¼‰</h3><p>æ‚¨å¯ä»¥ä½¿ç”¨scale()å‡½æ•°è½¬æ¢æ¥æ”¾å¤§æˆ–ç¼©å°SVGå…ƒç´ ã€‚ç¼©æ”¾å˜æ¢çš„è¯­æ³•æ˜¯ï¼š<br>scale(<sx> [<sy>])<br>scale() å‡½æ•°æ¥æ”¶ä¸€ä¸ªæˆ–ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æŒ‡å®šæ°´å¹³å’Œå‚ç›´ç¼©æ”¾å€¼ã€‚ sxè¡¨ç¤ºæ²¿xè½´çš„ç¼©æ”¾å€¼ï¼Œç”¨äºæ°´å¹³æ‹‰ä¼¸æˆ–æ”¶ç¼©å…ƒç´ ï¼› sy è¡¨ç¤ºæ²¿ y è½´çš„ç¼©æ”¾å€¼ï¼Œç”¨äºå‚ç›´æ‹‰ä¼¸æˆ–æ”¶ç¼©å…ƒç´ ã€‚<br>sy å€¼æ˜¯å¯é€‰çš„ï¼›å¦‚æœçœç•¥ï¼Œåˆ™å‡å®šç­‰äº sxã€‚ sx å’Œ sy å€¼å¯ä»¥ç”¨ç©ºæ ¼åˆ†éš”ï¼Œä¹Ÿå¯ä»¥ç”¨é€—å·åˆ†éš”ï¼Œå¹¶ä¸”å®ƒä»¬æ˜¯æ— å•ä½çš„æ•°å­—ã€‚<br>ä»¥ä¸‹ç¤ºä¾‹é€šè¿‡å°†å…ƒç´ ç¼©æ”¾åˆ°åŸå§‹å¤§å°çš„ä¸¤å€æ¥å°†å…ƒç´ çš„å¤§å°åŠ å€ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;150&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;scale(2)&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹ä»£ç å°†å…ƒç´ æ°´å¹³æ”¾å¤§ä¸ºåŸæ¥2å€ï¼Œå‚ç›´ç¼©å°ä¸ºåŸæ¥çš„ä¸€åŠï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;150&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;scale(2 0.5)&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨scale(2, .5)ï¼ˆå…¶ä¸­å€¼ä»¥é€—å·åˆ†éš”)ï¼Œåˆ™ä¸Šé¢çš„ç¤ºä¾‹ä»ç„¶æœ‰æ•ˆã€‚<br>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç¼©æ”¾ SVG å…ƒç´ æ—¶ï¼Œå…¶æ•´ä¸ªå½“å‰åæ ‡ç³»ä¹Ÿä¼šç¼©æ”¾ï¼Œå¯¼è‡´è¯¥å…ƒç´ ä¹Ÿåœ¨è§†å£å†…é‡æ–°å®šä½ã€‚</p><h3 id="å€¾æ–œï¼ˆSkewï¼‰"><a href="#å€¾æ–œï¼ˆSkewï¼‰" class="headerlink" title="å€¾æ–œï¼ˆSkewï¼‰"></a>å€¾æ–œï¼ˆSkewï¼‰</h3><p>SVG å…ƒç´ ä¹Ÿå¯ä»¥å€¾æ–œã€‚é€šè¿‡ä¸¤ä¸ªå‡½æ•°ï¼šskewX å’Œ skewYå®ç°å€¾æ–œæ“ä½œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">skewX</span>(&lt;skew-angle&gt;)<br><span class="hljs-title function_">skewY</span>(&lt;skew-angle&gt;)<br></code></pre></td></tr></table></figure><p>skewX å‡½æ•°æŒ‡å®šæ²¿ x è½´çš„å€¾æ–œå˜æ¢ï¼› skewY å‡½æ•°æŒ‡å®šæ²¿ y è½´çš„å€¾æ–œå˜æ¢ã€‚<br>æŒ‡å®šçš„å€¾æ–œè§’åº¦æ˜¯æ— å•ä½è§’åº¦ï¼Œé»˜è®¤ä¸ºåº¦ã€‚<br>è¯·æ³¨æ„ï¼Œå€¾æ–œå…ƒç´ å¯èƒ½ä¼šå¯¼è‡´å…ƒç´ åœ¨è§†å£å†…é‡æ–°å®šä½</p><h3 id="æ—‹è½¬ï¼ˆRotationï¼‰"><a href="#æ—‹è½¬ï¼ˆRotationï¼‰" class="headerlink" title="æ—‹è½¬ï¼ˆRotationï¼‰"></a>æ—‹è½¬ï¼ˆRotationï¼‰</h3><p>æ‚¨å¯ä»¥ä½¿ç”¨rotate()å‡½æ•°æ—‹è½¬SVGå…ƒç´ ã€‚è¯¥å‡½æ•°çš„è¯­æ³•æ˜¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">rotate</span>(&lt;rotate-angle&gt; [&lt;cx&gt; &lt;cy&gt;])<br></code></pre></td></tr></table></figure><p>rotate() å¯è®¾ç½®æŒ‡å®šç‚¹ï¼ŒæŒ‡å®šè§’åº¦è¿›è¡Œæ—‹è½¬ã€‚ä¸ CSS ä¸­çš„æ—‹è½¬å˜æ¢ä¸åŒï¼Œæ‚¨ä¸èƒ½æŒ‡å®šåº¦ä»¥å¤–çš„è§’åº¦å•ä½ã€‚è§’åº¦å€¼æŒ‡å®šä¸ºæ— å•ä½ï¼Œé»˜è®¤æƒ…å†µä¸‹è¢«è§†ä¸ºåº¦å€¼ã€‚<br>å¯é€‰çš„ cx å’Œ cy ç”¨äºè®¾ç½®æ—‹è½¬ä¸­å¿ƒï¼Œæ— å•ä½å€¼ã€‚å¦‚æœæœªæä¾› cx å’Œ cyï¼Œåˆ™æ—‹è½¬å›´ç»•å½“å‰ç”¨æˆ·åæ ‡ç³»çš„åŸç‚¹<br>åœ¨rotate()å‡½æ•°ä¸­æŒ‡å®šæ—‹è½¬ä¸­å¿ƒå°±åƒCSSä¸­è®¾ç½®transform:rotate()å’Œtransform-originçš„ç®€å†™æ–¹å¼ã€‚ç”±äº SVG ä¸­çš„é»˜è®¤æ—‹è½¬ä¸­å¿ƒæ˜¯å½“å‰ä½¿ç”¨çš„ç”¨æˆ·åæ ‡ç³»çš„å·¦ä¸Šè§’ï¼Œå¹¶ä¸”è¿™å¯èƒ½ä¸å…è®¸æ‚¨åˆ›å»ºæ‰€éœ€çš„æ—‹è½¬æ•ˆæœï¼Œå› æ­¤æ‚¨æœ€ç»ˆå¯èƒ½ä¼šåœ¨rotate() ä¸­æŒ‡å®šä¸€ä¸ªæ–°çš„ä¸­å¿ƒã€‚å¦‚æœæ‚¨çŸ¥é“å…ƒç´ åœ¨ SVG ç”»å¸ƒä¸­çš„å°ºå¯¸å’Œä½ç½®ï¼Œåˆ™å¯ä»¥è½»æ¾åœ°å°†å…¶ä¸­å¿ƒæŒ‡å®šä¸ºæ—‹è½¬ä¸­å¿ƒã€‚<br>ä»¥ä¸‹ç¤ºä¾‹å›´ç»•å½“å‰ç”¨æˆ·åæ ‡ç³»ä¸­ä½äº (50, 50) çš„æŒ‡å®šæ—‹è½¬ä¸­å¿ƒæ—‹è½¬ä¸€ç»„å…ƒç´ ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;parrot&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;rotate(45 50 50)&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;0&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- elements making up a parrot shape --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå¦‚æœä½ å¸Œæœ›å…ƒç´ ç»•å…¶ä¸­å¿ƒæ—‹è½¬ï¼Œä½ å¯èƒ½æƒ³å°†ä¸­å¿ƒæŒ‡å®šä¸º 50% 50%ï¼Œå°±åƒåœ¨ CSS ä¸­æ‰€åšçš„é‚£æ ·ï¼›ä½†ä¸å¹¸çš„æ˜¯ï¼Œåœ¨rotate()å‡½æ•°å†…éƒ¨è¿™æ ·åšæ˜¯ä¸å¯èƒ½çš„â€”â€”å¿…é¡»ä½¿ç”¨ç»å¯¹åæ ‡ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥ç»“åˆä½¿ç”¨ CSS å˜æ¢æºå±æ€§å’Œ CSS å˜æ¢å±æ€§æ¥æ‰§è¡Œæ­¤æ“ä½œ</p><h3 id="åæ ‡ç³»å˜æ¢"><a href="#åæ ‡ç³»å˜æ¢" class="headerlink" title="åæ ‡ç³»å˜æ¢"></a>åæ ‡ç³»å˜æ¢</h3><p>ç°åœ¨æˆ‘ä»¬å·²ç»æ¶µç›–äº† SVGæ‰€æœ‰çš„å˜æ¢æ–¹æ³• ï¼Œæˆ‘ä»¬æ·±å…¥åˆ°SVGå…ƒç´ åº”ç”¨å˜æ¢åçš„è§†è§‰å˜åŒ–ã€‚è¿™å°†æ˜¯SVG å˜æ¢æœ€é‡è¦çš„éƒ¨åˆ†ã€‚è¿™å°†æ˜¯å®ƒä»¬è¢«ç§°ä¸ºâ€œåæ ‡ç³»å˜æ¢â€è€Œä¸ä»…ä»…æ˜¯â€œå…ƒç´ å˜æ¢â€åŸå› ã€‚<br>åœ¨è¿™ä¸ªè§„èŒƒä¸­ï¼Œtransform å±æ€§è¢«å®šä¹‰å¯ä¸ºå…ƒç´ å»ºç«‹æ–°ç”¨æˆ·ç©ºé—´ï¼ˆå½“å‰åæ ‡ç³»ï¼‰çš„ä¸¤ä¸ªå±æ€§ä¹‹ä¸€ - viewBox å±äºå¦å¤–ä¸€ä¸ªã€‚é‚£ä¹ˆè¿™åˆ°åº•ä»£è¡¨ä»€ä¹ˆå‘¢ï¼Ÿ<br>The transform attribute establishes a new user space (current coordinate system) on the element it is | applied to.<br>æ­¤è¡Œä¸ºç±»ä¼¼äºåº”ç”¨äº HTML å…ƒç´ çš„ CSS è½¬æ¢çš„è¡Œä¸º â€” HTML å…ƒç´ çš„åæ ‡ç³»è¢«è½¬æ¢ï¼Œå½“è¿ç»­è½¬æ¢æ—¶é€šå¸¸æœ€ä¸ºæ˜æ˜¾ï¼ˆæˆ‘ä»¬ç¨åä¼šä»‹ç»ï¼‰ã€‚å°½ç®¡ HTML å’Œ SVG è½¬æ¢åœ¨è®¸å¤šæ–¹é¢ç›¸ä¼¼ï¼Œä½†å®ƒä»¬è¿˜æ˜¯å­˜åœ¨ä¸€äº›å·®å¼‚ã€‚<br>ä¸»è¦åŒºåˆ«åœ¨äºåæ ‡ç³»ã€‚ HTML å…ƒç´ çš„åæ ‡ç³»æ˜¯å»ºç«‹åœ¨å…ƒç´ æœ¬èº«ä¸Šçš„ã€‚åŒæ—¶ï¼Œåœ¨ SVG ä¸­ï¼Œå…ƒç´ çš„åæ ‡ç³»æœ€åˆæ˜¯å½“å‰ä½¿ç”¨çš„åæ ‡ç³»æˆ–ç”¨æˆ·ç©ºé—´ã€‚<br>å½“æ‚¨å°†å˜æ¢å±æ€§åº”ç”¨äº SVG å…ƒç´ æ—¶ï¼Œè¯¥å…ƒç´ å°†è·å¾—å½“å‰ä½¿ç”¨çš„ç”¨æˆ·åæ ‡ç³»çš„â€œå‰¯æœ¬â€ã€‚æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºåªæ˜¯ä¸ºè½¬æ¢åçš„å…ƒç´ åˆ›å»ºä¸€ä¸ªæ–°çš„â€œå›¾å±‚â€ï¼Œå…¶ä¸­æ–°å›¾å±‚æœ‰è‡ªå·±çš„å½“å‰ç”¨æˆ·åæ ‡ç³»ï¼ˆviewBoxï¼‰çš„å‰¯æœ¬ã€‚<br>ç„¶åï¼Œå…ƒç´ çš„æ–°å½“å‰åæ ‡ç³»é€šè¿‡å·²ç»è¢«å…ƒç´ çš„transfrom æŒ‡å®šå±æ€§å˜æ¢äº† ï¼Œä»è€Œå¯¼è‡´å…ƒç´ æœ¬èº«çš„å˜æ¢ã€‚å°±å¥½åƒå…ƒç´ è¢«ç»˜åˆ¶åˆ°å˜æ¢åçš„åæ ‡ç³»ä¸­çš„ç”»å¸ƒä¸Šä¸€æ ·ã€‚<br>è¦äº†è§£å¦‚ä½•åº”ç”¨ SVG è½¬æ¢ï¼Œè®©æˆ‘ä»¬ä»è§†è§‰éƒ¨åˆ†å¼€å§‹ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ SVG ç”»å¸ƒã€‚<br><img src="/img/svg/svg%E5%88%9D%E5%A7%8B%E5%9D%90%E6%A0%87%E7%B3%BB.png"></p><p>é¹¦é¹‰å’Œç‹—æ˜¯æˆ‘ä»¬è¦è½¬æ¢çš„å…ƒç´ ï¼ˆç»„ <g>ï¼‰ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 800 600&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;parrot&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the parrot --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the dog --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç°è‰²åæ ‡ç³»æ˜¯viewBoxå»ºç«‹çš„ç”»å¸ƒçš„åˆå§‹åæ ‡ç³»ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä¸ä¼šæ›´æ”¹åˆå§‹åæ ‡ç³» - æˆ‘ä½¿ç”¨ä¸è§†å£å¤§å°ç›¸åŒçš„ viewBoxï¼Œå¦‚ä¸Šé¢çš„ä»£ç æ‰€ç¤ºã€‚<br>When you apply the transform attribute to an SVG element, that element gets a â€œcopyâ€ of the current user coordinate system in use.<br>ç°åœ¨æˆ‘ä»¬å·²ç»å»ºç«‹äº†ç”»å¸ƒå’Œåˆå§‹ç”¨æˆ·ç©ºé—´ï¼Œæˆ‘ä»¬å°†å¼€å§‹è½¬æ¢å…ƒç´ ã€‚æˆ‘ä»¬é¦–å…ˆå°†é¹¦é¹‰å‘å·¦å¹³ç§» 150 ä¸ªå•ä½ï¼Œå‘ä¸‹å¹³ç§» 200 ä¸ªå•ä½ã€‚<br>å½“ç„¶ï¼Œé¹¦é¹‰æ˜¯ç”±å¤šç§è·¯å¾„å’Œå½¢çŠ¶ç»„æˆçš„ã€‚å°† Transform å±æ€§åº”ç”¨äºåŒ…è£¹è¿™äº›å½¢çŠ¶çš„ç»„ <g> å°±è¶³å¤Ÿäº†ï¼›è¿™ä¼šå°†g ä¸‹çš„æ‰€æœ‰å½¢çŠ¶éƒ½åšåŒç­‰å˜æ¢ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æœ‰å…³æ„å»ºå’Œåˆ†ç»„ SVG çš„æ–‡ç« ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 800 600&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;parrot&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;translate(150 200)&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the parrot --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- ... --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸‹å›¾å±•ç¤ºäº†é€šè¿‡ä¸Šé¢çš„å˜æ¢æ¥å¹³ç§»é¹¦é¹‰ã€‚é¹¦é¹‰çš„åŠé€æ˜ç‰ˆæœ¬æ˜¾ç¤ºåº”ç”¨å˜æ¢ä¹‹å‰çš„åˆå§‹ä½ç½®ã€‚<br><img src="/img/svg/translate-150-200.png"><br>Svg åº”ç”¨å˜æ¢åçš„æ•ˆæœå’ŒHTMLå…ƒç´ åº”ç”¨äº†CSS å˜æ¢æ•ˆæœä¸€è‡´ ã€‚æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡ï¼Œå…ƒç´ åŸºäºtransfrom å±æ€§ä¼šå»ºç«‹ä¸€ä¸ªæ–°çš„å½“å‰ç”¨æˆ·åæ ‡ç³»ã€‚ä¸‹å›¾åœ¨ é¹¦é¹‰å…ƒç´ åœ¨å˜æ¢åå»ºç«‹çš„åˆå§‹åæ ‡ç³»çš„â€œå‰¯æœ¬â€ã€‚æ³¨æ„é¹¦é¹‰å½“å‰çš„åæ ‡ç³»æ˜¯å¦‚ä½•å¹³ç§»çš„ã€‚<br><img src="/img/svg/%E5%B9%B3%E7%A7%BB%E5%AF%B9%E6%AF%94.png"><br>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å…ƒç´ ä¸Šå»ºç«‹çš„æ–°å½“å‰åæ ‡ç³»æ˜¯åˆå§‹ç”¨æˆ·ç©ºé—´çš„å¤åˆ¶ï¼Œå…¶ä¸­ä¿ç•™äº†å…ƒç´ çš„ä½ç½®ã€‚è¿™æ„å‘³ç€å®ƒä¸æ˜¯å»ºç«‹åœ¨å…ƒç´ çš„è¾¹ç•Œä¸Šï¼Œæ–°çš„å½“å‰åæ ‡ç³»çš„å¤§å°ä¹Ÿä¸å—å…ƒç´ å¤§å°çš„é™åˆ¶ã€‚è¿™å°±æ˜¯ HTML å’Œ SVG åæ ‡ç³»ä¹‹é—´çš„å·®å¼‚æ‰€åœ¨ã€‚<br>ç°åœ¨è®©æˆ‘ä»¬å°è¯•åˆ«çš„ä¸œè¥¿ã€‚æˆ‘ä»¬è¦æŠŠé¹¦é¹‰æ”¾å¤§ä¸€å€ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 800 600&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;parrot&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;scale(2)&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the parrot --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- ... --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¼©æ”¾ SVG å…ƒç´ çš„ç»“æœä¸ç¼©æ”¾ HTML å…ƒç´ çš„ç»“æœä¸åŒã€‚ç¼©æ”¾åçš„ SVG å…ƒç´ çš„ä½ç½®åœ¨è§†å£å†…å‘ç”Ÿå˜åŒ–ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†å°†é¹¦é¹‰çš„å°ºå¯¸æ”¾å¤§ä¸€å€çš„ç»“æœã€‚æ³¨æ„åˆå§‹ä½ç½®å’Œå¤§å°ï¼Œä»¥åŠæœ€ç»ˆå¤§å°å’Œä½ç½®ã€‚<br><img src="/img/svg/%E6%94%BE%E5%A4%A7%E4%B8%80%E5%80%8D.png"><br>ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œä¸ä»…é¹¦é¹‰çš„å°ºå¯¸ï¼ˆå®½åº¦å’Œé«˜åº¦ï¼‰å¢åŠ äº†ä¸€å€ï¼Œè€Œä¸”åæ ‡ï¼ˆxå’Œyï¼‰ä¹Ÿä¹˜ä»¥ç¼©æ”¾å› å­ï¼ˆè¿™é‡Œæ˜¯2ï¼‰<br>æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°è¿™ä¸ªç»“æœçš„åŸå› æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ï¼šå…ƒç´ å½“å‰çš„åæ ‡ç³»è¢«è½¬æ¢ï¼Œç„¶åé¹¦é¹‰è¢«ç»˜åˆ¶åˆ°æ–°çš„ç³»ç»Ÿä¸­ã€‚å› æ­¤ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œå½“å‰åæ ‡ç³»å·²ç¼©æ”¾ã€‚æ­¤æ•ˆæœç±»ä¼¼äºä½¿ç”¨ viewBox &#x3D; â€œ0 0 400 300â€ çš„æ•ˆæœï¼Œå®ƒâ€œæ”¾å¤§â€åˆ°åæ ‡ç³»ï¼Œä»è€Œå°†å…¶ä¸­å†…å®¹çš„å¤§å°åŠ å€<br>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å°†é¹¦é¹‰å˜æ¢åçš„å½“å‰åæ ‡ç³»ç»˜åˆ¶å‡ºæ¥ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š<br><img src="/img/svg/%E5%A4%A7%E5%B0%8F%E5%8A%A0%E5%80%8D.png"><br>é¹¦é¹‰çš„æ–°å½“å‰åæ ‡ç³»è¢«æ”¾å¤§ï¼ŒåŒæ—¶â€œæ”¾å¤§â€åˆ°é¹¦é¹‰ã€‚è¯·æ³¨æ„ï¼Œåœ¨å½“å‰åæ ‡ç³»å†…ï¼Œé¹¦é¹‰ä¸ä¼šé‡æ–°å®šä½ï¼Œåªæ˜¯ç¼©æ”¾åæ ‡ç³»çš„æ•ˆæœå°†å…¶åœ¨è§†å£å†…é‡æ–°å®šä½ã€‚é¹¦é¹‰è¢«æ”¾å¤§åçš„åæ ‡ç³»ä¸­ä»¥å…¶åŸå§‹ x å’Œ y åæ ‡ç»˜åˆ¶ã€‚<br>è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸åŒçš„ç¼©æ”¾å› å­åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šç¼©æ”¾é¹¦é¹‰ã€‚å¦‚æœæˆ‘ä»¬é€šè¿‡åº”ç”¨transform&#x3D;â€scale(2 0.5)æ¥ç¼©æ”¾é¹¦é¹‰ï¼Œæˆ‘ä»¬ä¼šå°†å…¶å®½åº¦åŠ å€ï¼ŒåŒæ—¶ä½¿å…¶é«˜åº¦ä¸ºåŸå§‹é«˜åº¦çš„ä¸€åŠã€‚æ•ˆæœå°†ç±»ä¼¼äºåº”ç”¨viewBox&#x3D;â€0 0 400 1200â€ã€‚<br><img src="/img/svg/viewBox%E6%94%BE%E5%A4%A7.png"><br>æ³¨æ„é¹¦é¹‰åœ¨ç¼©æ”¾åæ ‡ç³»å†…çš„ä½ç½®ï¼Œå¹¶å°†å…¶ä¸åˆå§‹ç³»ç»Ÿï¼ˆåŠé€æ˜é¹¦é¹‰ï¼‰ä¸­çš„ä½ç½®è¿›è¡Œæ¯”è¾ƒï¼šx å’Œ y ä½ç½®åæ ‡è¢«ä¿ç•™ã€‚<br>å€¾æ–œ SVG ä¸­çš„å…ƒç´ ä¹Ÿä¼šå¯¼è‡´è¯¥å…ƒç´ å› å…¶å½“å‰åæ ‡ç³»å€¾æ–œè€Œè¢«â€œç§»åŠ¨â€ã€‚<br>å‡è®¾æˆ‘ä»¬ä½¿ç”¨ skewX å‡½æ•°æ²¿ x è½´å¯¹ç‹—åº”ç”¨å€¾æ–œå˜æ¢ã€‚æˆ‘ä»¬è¦å°†ç‹—æ°´å¹³å€¾æ–œ 25 åº¦ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 800 600&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- ... --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;skewX(25)&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the dog --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸‹å›¾æ˜¾ç¤ºäº†å¯¹ç‹—åº”ç”¨å€¾æ–œå˜æ¢çš„ç»“æœã€‚å®ƒçš„åæ ‡ç³»æ˜¯å€¾æ–œï¼Œæ‰€ä»¥å°ç‹—ä¹Ÿæ˜¯å€¾æ–œçš„<br><img src="/img/svg/x%E8%BD%B4%E5%80%BE%E6%96%9C.png"><br>è¯·æ³¨æ„ï¼Œç”±äºåæ ‡ç³»å€¾æ–œï¼Œç‹—çš„ä½ç½®ç›¸å¯¹äºå…¶åŸå§‹ä½ç½®ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚<br>ä¸‹å›¾æ˜¾ç¤ºäº†ä½¿ç”¨ skewY() è€Œä¸æ˜¯ skewX å°†ç‹—å€¾æ–œç›¸åŒè§’åº¦çš„ç»“æœï¼š<br><img src="/img/svg/Y%E8%BD%B4%E5%80%BE%E6%96%9C.png"><br>ï¼Œè®©æˆ‘ä»¬å°è¯•æ—‹è½¬é¹¦é¹‰ã€‚é»˜è®¤æ—‹è½¬ä¸­å¿ƒæ˜¯å½“å‰ç”¨æˆ·åæ ‡ç³»çš„å·¦ä¸Šè§’ã€‚å»ºç«‹åœ¨æ—‹è½¬å…ƒç´ ä¸Šçš„æ–°çš„å½“å‰ç³»ç»Ÿä¹Ÿå°†è¢«æ—‹è½¬ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠé¹¦é¹‰æ—‹è½¬ 45 åº¦ã€‚æ­£æ—‹è½¬æ–¹å‘ä¸ºé¡ºæ—¶é’ˆæ–¹å‘ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 800 600&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;parrot&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;rotate(45)&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the parrot --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- ... --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°è½¬æ¢çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/img/svg/%E6%97%A0%E4%B8%AD%E5%BF%83%E7%82%B9%E6%97%8B%E8%BD%AC.png"><br>é™¤äº†åæ ‡ç³»çš„é»˜è®¤åŸç‚¹å¤–ï¼Œä½ å¯èƒ½è¿˜æƒ³å›´ç»•æŸä¸ªç‚¹æ—‹è½¬æŸä¸ªå…ƒç´ ã€‚ä½¿ç”¨ transform å±æ€§ä¸­çš„ rotate() å‡½æ•°ï¼Œå¯ä»¥æ˜ç¡®æŒ‡å®šè¯¥ç‚¹ã€‚å‡è®¾æˆ‘ä»¬è¦å°†æœ¬ç¤ºä¾‹ä¸­çš„é¹¦é¹‰å›´ç»•å…¶ä¸­å¿ƒæ—‹è½¬ã€‚æ ¹æ®é¹¦é¹‰çš„å®½åº¦ã€é«˜åº¦å’Œä½ç½®ï¼Œæˆ‘å¯ä»¥ç¡®å®šå®ƒçš„ä¸­å¿ƒå¤§çº¦åœ¨ï¼ˆ150ï¼Œ170ï¼‰å¤„ã€‚ç„¶åå°±å¯ä»¥å›´ç»•è¿™ä¸€ç‚¹æ—‹è½¬é¹¦é¹‰ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;800&quot;</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">&quot;0 0 800 600&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">g</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;parrot&quot;</span> <span class="hljs-attr">transform</span>=<span class="hljs-string">&quot;rotate(45 150 170)&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!-- shapes and paths forming the parrot --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">g</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- ... --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œé¹¦é¹‰è¢«æ—‹è½¬ï¼Œçœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š<br><img src="/img/svg/%E6%8C%87%E5%AE%9A%E7%82%B9%E6%97%8B%E8%BD%AC.png"><br>æˆ‘ä»¬è¯´è¿‡ï¼Œå˜æ¢æ˜¯ä½œç”¨äºåæ ‡ç³»ï¼Œå› æ­¤å…ƒç´ æœ€ç»ˆä¹Ÿä¼šå—åˆ°å½±å“å¹¶å‘ç”Ÿå˜æ¢ã€‚é‚£ä¹ˆï¼Œå¯¹äºåŸç‚¹ä½äºç‚¹ï¼ˆ0ï¼Œ0ï¼‰çš„åæ ‡ç³»æ¥è¯´ï¼Œæ”¹å˜æ—‹è½¬ä¸­å¿ƒç©¶ç«Ÿæ˜¯å¦‚ä½•èµ·ä½œç”¨çš„å‘¢ï¼Ÿ<br>å½“ä½ æ›´æ”¹æ—‹è½¬ä¸­å¿ƒæ—¶ï¼Œåæ ‡ç³»å…ˆå¹³ç§»ï¼Œå†æ—‹è½¬æŒ‡å®šè§’åº¦ï¼Œç„¶åæ ¹æ®æ‚¨æŒ‡å®šçš„æ—‹è½¬ä¸­å¿ƒå†æ¬¡å¹³ç§»ç‰¹å®šå€¼ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­</p><pre><code class="html">&lt;g id=&quot;parrot&quot; transform=&quot;rotate(45 150 170)&quot;&gt;</code></pre><p>æµè§ˆå™¨é€šè¿‡æ‰§è¡Œäº†ä¸€ç³»åˆ—çš„å¹³ç§»å’Œæ—‹è½¬æ“ä½œç›¸å½“äºï¼š</p><pre><code class="html">&lt;g id=&quot;parrot&quot; transform=&quot;translate(150 170) rotate(45) translate(-150 -170)&quot;&gt;  </code></pre><p>å½“å‰åæ ‡ç³»å°†å¹³ç§»åˆ°ä½ è®¾ç½®çš„ä¸­å¿ƒç‚¹ã€‚ç„¶åå®ƒä¼šæ ¹æ®ä½ æŒ‡å®šè§’åº¦è¿›è¡Œæ—‹è½¬ã€‚æœ€åï¼Œåœ¨åå‘å¹³ç§»å›æ¥ã€‚ä¸Šè¿°å˜æ¢è§†è§‰æ•ˆæœå¦‚ä¸‹<br><img src="/img/svg/%E5%B9%B3%E7%A7%BB-%E6%97%8B%E8%BD%AC-%E5%B9%B3%E7%A7%BB.png"><br>åœ¨è¿›å…¥ä¸‹ä¸€èŠ‚åµŒå¥—å’Œé“¾å¼å˜æ¢ä¹‹å‰ï¼Œæˆ‘æƒ³æŒ‡å‡ºçš„æ˜¯ï¼Œæ¯ä¸€ä¸ªå…ƒç´ é€šè¿‡å˜æ¢åçš„ç”¨æˆ·åæ ‡ç³»ä¹‹é—´éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ç‹—å’Œé¹¦é¹‰ä¸Šå»ºç«‹çš„ä¸¤ä¸ªåæ ‡ç³»ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•ç›¸äº’ç‹¬ç«‹çš„ã€‚<br><img src="/img/svg/%E5%9D%90%E6%A0%87%E7%B3%BB%E7%8B%AC%E7%AB%8B.png"><br>å¦è¯·æ³¨æ„ï¼Œæ¯ä¸ªå½“å‰åæ ‡ç³»éƒ½éš¶å±äº<svg> ä¸Šçš„ viewBox å±æ€§å»ºç«‹çš„ç”»å¸ƒçš„ä¸»åæ ‡ç³»å†…ï¼ŒviewBox çš„ä»»ä½•å˜æ¢éƒ½ä¼šå½±å“æ•´ä¸ªç”»å¸ƒåŠå…¶å†…éƒ¨çš„æ‰€æœ‰å…ƒç´ ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦æœ‰è‡ªå·±å»ºç«‹çš„åæ ‡ç³»ã€‚<br>ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯å°†æ•´ä¸ªç”»å¸ƒçš„ç”¨æˆ·ç©ºé—´ä» viewBox&#x3D;â€0 0 800 600â€ æ›´æ”¹ä¸º viewBox&#x3D;â€0 0 600 450â€ çš„ç»“æœã€‚æ•´ä¸ªç”»å¸ƒè¢«æ”¾å¤§ï¼ŒåŒæ—¶ä¿ç•™æ¯ä¸ªå…ƒç´ åŸæœ‰çš„å˜æ¢<br><img src="/img/svg/%E6%94%BE%E5%A4%A7.png"><br>å¯¹æ¯”ä¸Šé¢çš„å›¾ç‰‡çœ‹ä¸€ä¸‹<br><img src="/img/svg/viewbox%E5%AF%B9%E6%AF%94.png"><br>åµŒå¥—å’Œé“¾å¼è½¬æ¢<br>å¾ˆå¤šæ—¶å€™ä½ å¯èƒ½æƒ³è¦å¯¹ä¸€ä¸ªå…ƒç´ åº”ç”¨å¤šä¸ªè½¬æ¢ã€‚åœ¨åŸå§‹å…ƒç´ ä¸Šåº”ç”¨å¤šä¸ªè½¬æ¢å°±æ˜¯æ‰€è°“çš„â€œé“¾å¼â€è½¬æ¢ã€‚<br>å½“åº”ç”¨é“¾å¼å˜æ¢æ—¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯:åƒ HTML å…ƒç´ å˜æ¢ä¸€æ ·ï¼Œæ¯ä¸ªå˜æ¢éƒ½æ˜¯åŸºäºå‰ä¸€æ¬¡å˜æ¢åçš„ç”¨æˆ·åæ ‡ç³»è¿›è¡Œå˜æ¢ã€‚<br>ä¾‹å¦‚ï¼Œå…ƒç´ è¦å…ˆæ—‹è½¬åœ¨å¹³ç§»ï¼Œåˆ™å¹³ç§»å°†æ ¹æ®æ—‹è½¬åçš„æ–°çš„åæ ‡ç³»è¿›è¡Œï¼Œè€Œä¸æ˜¯åˆå§‹çš„éæ—‹è½¬åæ ‡ç³»ã€‚<br>ä¸‹é¢çš„ä¾‹å­å°±æ˜¯è¿™æ ·åšçš„ã€‚æˆ‘ä»¬åº”ç”¨ä¹‹å‰çš„æ—‹è½¬ï¼Œç„¶åæ²¿æ­£ x-axistransform&#x3D;â€rotate(45 150 170) translate(200)â€ å°†é¹¦é¹‰å¹³ç§» 200 ä¸ªå•ä½ã€‚<br><img src="/img/svg/%E5%B5%8C%E5%A5%97%E9%93%BE%E5%BC%8F%E9%93%BE%E5%BC%8F%E8%BD%AC%E6%8D%A2.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>node.js éƒ¨ç½²è„šæœ¬</title>
    <link href="/2023/09/26/micro-deploy/micro-deploy/"/>
    <url>/2023/09/26/micro-deploy/micro-deploy/</url>
    
    <content type="html"><![CDATA[<h1 id="node-js-è‡ªåŠ¨æ‰“åŒ…-éƒ¨ç½²è„šæœ¬"><a href="#node-js-è‡ªåŠ¨æ‰“åŒ…-éƒ¨ç½²è„šæœ¬" class="headerlink" title="node.js è‡ªåŠ¨æ‰“åŒ…&amp;&amp;éƒ¨ç½²è„šæœ¬"></a>node.js è‡ªåŠ¨æ‰“åŒ…&amp;&amp;éƒ¨ç½²è„šæœ¬</h1><h2 id="æ­å»ºé¡¹ç›®"><a href="#æ­å»ºé¡¹ç›®" class="headerlink" title="æ­å»ºé¡¹ç›®"></a>æ­å»ºé¡¹ç›®</h2><blockquote><p>é‡‡ç”¨ ES module ç”¨æ³•ï¼Œpackage.json type éœ€è¦è®¾ç½®ä¸º module </p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm init<br></code></pre></td></tr></table></figure><h2 id="æ·»åŠ é…ç½®æ–‡ä»¶server-json"><a href="#æ·»åŠ é…ç½®æ–‡ä»¶server-json" class="headerlink" title="æ·»åŠ é…ç½®æ–‡ä»¶server.json"></a>æ·»åŠ é…ç½®æ–‡ä»¶server.json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;****&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;****&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*****&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;****&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">22</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;localDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;release/&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;backUp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>  <span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><h2 id="è¯»å–é…ç½®æ–‡ä»¶"><a href="#è¯»å–é…ç½®æ–‡ä»¶" class="headerlink" title="è¯»å–é…ç½®æ–‡ä»¶"></a>è¯»å–é…ç½®æ–‡ä»¶</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;fs&quot;</span>;<br><span class="hljs-keyword">const</span> configFilePath = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">&quot;server.json&quot;</span>);<br><span class="hljs-keyword">const</span> config = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(configFilePath));<br></code></pre></td></tr></table></figure><h2 id="é“¾æ¥æœåŠ¡å™¨"><a href="#é“¾æ¥æœåŠ¡å™¨" class="headerlink" title="é“¾æ¥æœåŠ¡å™¨"></a>é“¾æ¥æœåŠ¡å™¨</h2><p>å®‰è£… node-ssh ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i node-ssh -D<br>npm i ora -D <br>npm i chalk -D<br></code></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> chalk <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;chalk&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Ora</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;ora&quot;</span>;<br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">connectServer</span>(<span class="hljs-params">config</span>) &#123;<br>  <span class="hljs-keyword">let</span> spinner = <span class="hljs-title class_">Ora</span>(chalk.<span class="hljs-title function_">cyan</span>(<span class="hljs-string">`[info] connecting server....\n`</span>)).<span class="hljs-title function_">start</span>();<br>  <span class="hljs-keyword">const</span> sshLoginParam = &#123;<br>    <span class="hljs-attr">host</span>: config.<span class="hljs-property">host</span>,<br>    <span class="hljs-attr">port</span>: config.<span class="hljs-property">port</span>,<br>    <span class="hljs-attr">username</span>: config.<span class="hljs-property">username</span>,<br>    <span class="hljs-attr">password</span>: config.<span class="hljs-property">password</span>,<br>  &#125;;<br><span class="hljs-comment">//   é“¾æ¥</span><br>  <span class="hljs-keyword">await</span> <span class="hljs-variable constant_">SSH</span>.<span class="hljs-title function_">connect</span>(sshLoginParam)<br>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      spinner.<span class="hljs-title function_">succeed</span>(chalk.<span class="hljs-title function_">green</span>(<span class="hljs-string">`[info] connected server \n`</span>));<br>    &#125;)<br>    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      spinner.<span class="hljs-title function_">fail</span>(chalk.<span class="hljs-title function_">red</span>(<span class="hljs-string">`[error] connect server failed\n`</span>));<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);<br>      process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ·»åŠ æ‰§è¡Œå‘½ä»¤æ–¹æ³•"><a href="#æ·»åŠ æ‰§è¡Œå‘½ä»¤æ–¹æ³•" class="headerlink" title="æ·»åŠ æ‰§è¡Œå‘½ä»¤æ–¹æ³•"></a>æ·»åŠ æ‰§è¡Œå‘½ä»¤æ–¹æ³•</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// cmd éœ€è¦æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="hljs-comment">// cwd æ‰§è¡Œå‘½ä»¤æ‰€åœ¨çš„ç›®å½•</span><br><span class="hljs-comment">// await runCommand(`rm -rf test-dir`, &#x27;/home&#x27;)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">runCommand</span>(<span class="hljs-params">cmd, cwd</span>) &#123;<br>  <span class="hljs-keyword">await</span> <span class="hljs-variable constant_">SSH</span>.<span class="hljs-title function_">execCommand</span>(cmd, &#123;<br>    cwd,<br>    <span class="hljs-comment">// onStderr(chunk) &#123;</span><br>    <span class="hljs-comment">//   logError(`$&#123;cmd&#125;, stderrChunk, $&#123;chunk.toString(&quot;utf8&quot;)&#125;`);</span><br>    <span class="hljs-comment">// &#125;,</span><br>  &#125;);<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="æ‰§è¡Œæ¨é€æ–‡ä»¶åˆ°è¿œç¨‹"><a href="#æ‰§è¡Œæ¨é€æ–‡ä»¶åˆ°è¿œç¨‹" class="headerlink" title="æ‰§è¡Œæ¨é€æ–‡ä»¶åˆ°è¿œç¨‹"></a>æ‰§è¡Œæ¨é€æ–‡ä»¶åˆ°è¿œç¨‹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// localDir æœ¬åœ°æ–‡ä»¶ç›®å½•</span><br><span class="hljs-comment">// remoteDir è¿œç¨‹æ–‡ä»¶ç›®å½•</span><br><span class="hljs-keyword">await</span> <span class="hljs-variable constant_">SSH</span>.<span class="hljs-title function_">putDirectory</span>(localDir, remoteDir);<br></code></pre></td></tr></table></figure><h2 id="child-process-å¼€å¯å­shellæ‰§è¡Œå‘½ä»¤"><a href="#child-process-å¼€å¯å­shellæ‰§è¡Œå‘½ä»¤" class="headerlink" title="child_process å¼€å¯å­shellæ‰§è¡Œå‘½ä»¤"></a>child_process å¼€å¯å­shellæ‰§è¡Œå‘½ä»¤</h2><!-- @example spawnCommand('yarn', ['build'], process.cwd()) --><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">spawnCommand</span> = (<span class="hljs-params">command, params, cwd</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">spawn</span>(command, params, &#123;<br>      cwd,<br>      <span class="hljs-attr">stdio</span>: <span class="hljs-string">&#x27;inherit&#x27;</span>, <span class="hljs-comment">// æ‰“å°å‘½ä»¤åŸå§‹è¾“å‡º</span><br>      <span class="hljs-comment">// åœ¨mac ç¯å¢ƒä¸‹å‡ºé—®é¢˜æ˜¯å¯ä»¥å°è¯•ç›´æ¥å°†shell è®¾ç½®ä¸ºtrue</span><br>      <span class="hljs-attr">shell</span>: process.<span class="hljs-property">platform</span> === <span class="hljs-string">&#x27;win32&#x27;</span>, <span class="hljs-comment">// å…¼å®¹windowsç³»ç»Ÿ</span><br>    &#125;);<br><br>    result.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      <span class="hljs-title function_">reject</span>(err);<br>    &#125;);<br><br>    result.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">code</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (code === <span class="hljs-number">0</span>) <span class="hljs-title function_">resolve</span>();<br>      <span class="hljs-keyword">else</span> <span class="hljs-title function_">reject</span>(code);<br>    &#125;);<br>  &#125;);<br>&#125;;<br><br></code></pre></td></tr></table></figure><h1 id="å®Œæ•´ç¤ºä¾‹"><a href="#å®Œæ•´ç¤ºä¾‹" class="headerlink" title="å®Œæ•´ç¤ºä¾‹"></a>å®Œæ•´ç¤ºä¾‹</h1><pre><code class="js">import Ora from &quot;ora&quot;;import * as NodeSSH from &quot;node-ssh&quot;;import fs from &quot;fs&quot;;import * as path from &quot;path&quot;;import chalk from &quot;chalk&quot;;import  &#123; spawn &#125; from &#39;child_process&#39;;// æ ¹ç›®å½•const REMOTE_ROOT = &quot;/home/simtek-cloud/front/all/html&quot;;// ä¸»APPç›®å½•const MAIN_APP = `main-app`;const SSH = new NodeSSH.NodeSSH();const logInfo = (text) =&gt; console.log(chalk.cyan(text));const logSuccess = (text) =&gt; console.log(chalk.green(text));const logError = (text) =&gt; console.log(chalk.red(text));/** * spawnCommand æ‰§è¡Œshellå‘½ä»¤ * @param &#123;*&#125; command å‘½ä»¤ string * @param &#123;*&#125; params å‚æ•° array * @param &#123;*&#125; cwd å·¥ä½œè·¯å¾„ * @example spawnCommand(&#39;yarn&#39;, [&#39;build&#39;], process.cwd()) */const spawnCommand = (command, params, cwd) =&gt; &#123;  return new Promise((resolve, reject) =&gt; &#123;    const result = spawn(command, params, &#123;      cwd,      stdio: &#39;inherit&#39;, // æ‰“å°å‘½ä»¤åŸå§‹è¾“å‡º      shell: process.platform === &#39;win32&#39;, // å…¼å®¹windowsç³»ç»Ÿ    &#125;);    result.on(&#39;error&#39;, (err) =&gt; &#123;      reject(err);    &#125;);    result.on(&#39;close&#39;, (code) =&gt; &#123;      if (code === 0) resolve();      else reject(code);    &#125;);  &#125;);&#125;;async function runCommand(cmd, cwd) &#123;  await SSH.execCommand(cmd, &#123;    cwd,    onStderr(chunk) &#123;      logError(`$&#123;cmd&#125;, stderrChunk, $&#123;chunk.toString(&quot;utf8&quot;)&#125;`);    &#125;,  &#125;);&#125;const configFilePath = path.resolve(process.cwd(), &quot;server.json&quot;);const config = JSON.parse(fs.readFileSync(configFilePath));async function connectServer(config) &#123;  let spinner = Ora(chalk.cyan(`[info] connecting server....\n`)).start();  const sshLoginParam = &#123;    host: config.host,    port: config.port,    username: config.username,    password: config.password,  &#125;;  await SSH.connect(sshLoginParam)    .then(() =&gt; &#123;      spinner.succeed(chalk.green(`[info] connected server \n`));    &#125;)    .catch((err) =&gt; &#123;      spinner.fail(chalk.red(`[error] connect server failed\n`));      console.log(err);      process.exit(1);    &#125;);&#125;async function deleteMainAppDir() &#123;  const spinner = Ora(    chalk.cyan(`[info] delete remote dir: main-app\n`)  ).start();  // åˆ é™¤æºç›®å½•  await runCommand(`rm -rf $&#123;MAIN_APP&#125;`, config.path).catch((err) =&gt; &#123;    spinner.fail(chalk.red(&quot;åˆ é™¤æ–‡ä»¶å¤±è´¥äº†&quot;));    console.log(&quot;[error]chmod: &quot;, err);  &#125;);  spinner.succeed(chalk.green(`[info] remote dir [main-app] is deleted`));&#125;/** * @description: æ¨é€æ¨é€main app * @return &#123;*&#125; */async function putMainAppDir() &#123;  const localDir = path.resolve(process.cwd(), `main-app/dist`);  const remoteDir = `$&#123;config.path&#125;/$&#123;MAIN_APP&#125;`;  const successText = `[info] push $&#123;localDir&#125; to $&#123;remoteDir&#125;\n`;  const spinner = Ora(chalk.cyan(successText)).start();  try &#123;    await SSH.putDirectory(localDir, remoteDir);    spinner.succeed(chalk.green(successText));  &#125; catch (e) &#123;    spinner.fail(chalk.red(successText));  &#125;&#125;/** * @description: é‡å¯docker å®¹å™¨ * @return &#123;*&#125; */async function restartDocker() &#123;  const spinner = Ora(chalk.cyan(`[info] restart docker\n`)).start();  // é‡å¯docker å®¹å™¨  try &#123;    // å¦‚æœéœ€è¦è¾“å…¥å¯†ç  å¯ä»¥å¸¸é€šè¿‡ sudo -S é…ç½® ä»æ ‡å‡†è¾“å…¥æµè·å–å¯†ç     // echo $&#123;passsword&#125; | sudo docker restart all    await runCommand(`docker restart all`, config.path).catch((err) =&gt; &#123;      console.log(&quot;[error]unzip: &quot;, err);    &#125;);    spinner.succeed(chalk.green(`[error] restart docker\n`));  &#125; catch (e) &#123;    spinner.fail(chalk.red(`[error] restart docker\n`));  &#125;&#125;async function deploy() &#123;  console.log(`======= åŠ è½½é…ç½®æ–‡ä»¶ ==========`);  console.log(config);  await spawnCommand(&#39;npm run&#39;, [&#39;build:all&#39;], process.cwd())  await connectServer(config);  // åˆ é™¤ç›®å½•  await deleteMainAppDir();  // ä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•  await putMainAppDir();  // é‡å¯docker  await restartDocker();  SSH.dispose();&#125;deploy();</code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>micro-editor-python-lsp</title>
    <link href="/2023/09/16/python-lsp/python-lsp/"/>
    <url>/2023/09/16/python-lsp/python-lsp/</url>
    
    <content type="html"><![CDATA[<p>MAC ç¯å¢ƒ</p><h1 id="å®‰è£…python-ç¯å¢ƒ"><a href="#å®‰è£…python-ç¯å¢ƒ" class="headerlink" title="å®‰è£…python ç¯å¢ƒ"></a>å®‰è£…python ç¯å¢ƒ</h1><h2 id="å®‰è£…-pyenv-virtualenv"><a href="#å®‰è£…-pyenv-virtualenv" class="headerlink" title="å®‰è£… pyenv-virtualenv"></a>å®‰è£… pyenv-virtualenv</h2><p>ä½¿ç”¨ Homebrew å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">brew install pyenv-virtualenv<br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºéš”ç¦»çš„å·¥ä½œç¯å¢ƒ"><a href="#åˆ›å»ºéš”ç¦»çš„å·¥ä½œç¯å¢ƒ" class="headerlink" title="åˆ›å»ºéš”ç¦»çš„å·¥ä½œç¯å¢ƒ"></a>åˆ›å»ºéš”ç¦»çš„å·¥ä½œç¯å¢ƒ</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">pyenv virtualenv (<span class="hljs-name">python-version</span>) (<span class="hljs-name">workspace-name</span>)<br></code></pre></td></tr></table></figure><h2 id="æ¿€æ´»ç¯å¢ƒï¼š"><a href="#æ¿€æ´»ç¯å¢ƒï¼š" class="headerlink" title="æ¿€æ´»ç¯å¢ƒï¼š"></a>æ¿€æ´»ç¯å¢ƒï¼š</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">pyenv <span class="hljs-built_in">activate</span> (workspace-<span class="hljs-built_in">name</span>)<br></code></pre></td></tr></table></figure><h2 id="é€€å‡ºç¯å¢ƒï¼š"><a href="#é€€å‡ºç¯å¢ƒï¼š" class="headerlink" title="é€€å‡ºç¯å¢ƒï¼š"></a>é€€å‡ºç¯å¢ƒï¼š</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">pyenv deactivate</span><br></code></pre></td></tr></table></figure><p>#å®‰è£…python </p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="http://wiki.geekdream.com/Specification/json-rpc_2.0.html#41">JSON-RPC</a><br><a href="https://www.typefox.io/blog/teaching-the-language-server-protocol-to-microsofts-monaco-editor">teaching-the-language-server-protocol-to-microsofts-monaco-editor</a></p>]]></content>
    
    
    <categories>
      
      <category>pythonä»£ç ç¼–è¾‘å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>svg åŠ¨ç”»</title>
    <link href="/2023/09/10/svg/svg-animate/"/>
    <url>/2023/09/10/svg/svg-animate/</url>
    
    <content type="html"><![CDATA[<h1 id="svg-åŠ¨ç”»"><a href="#svg-åŠ¨ç”»" class="headerlink" title="svg åŠ¨ç”»"></a>svg åŠ¨ç”»</h1><p><a href="https://css-tricks.com/guide-svg-animations-smil/">åŠ¨ç”»å‚è€ƒèµ„æ–™é“¾æ¥é“¾æ¥</a> <a href="https://css-tricks.com/guide-svg-animations-smil/">https://css-tricks.com/guide-svg-animations-smil/</a></p><h2 id="SVG-dasharray"><a href="#SVG-dasharray" class="headerlink" title="SVG dasharray"></a>SVG dasharray</h2><p>stroke-dasharray å±æ€§å¯ä»¥è®¾ç½®çº¿æ®µç»˜åˆ¶æ—¶çš„é—´éš”<br>stroke-dasharray æ•°å€¼å‹å€¼ å¯ä»¥é…ç½®2ä¸ªï¼Œç¬¬äºŒä¸ªå€¼ç¼ºçœ</p><ul><li>stroke-dasharray&#x3D;â€4â€ ä»£è¡¨dash å€¼å’Œoffseté—´è·ä¿æŒä¸€ç›´</li><li>stroke-dasharray&#x3D;â€4 5â€  dashå®½åº¦ä¸º4ï¼Œæ¯ä¸€å—é—´è·ä¸º5</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">baseProfile</span>=<span class="hljs-string">&quot;full&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100%&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 200, L200, 200, L400, 200&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h2 id="stroke-dashoffset"><a href="#stroke-dashoffset" class="headerlink" title="stroke-dashoffset"></a><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dashoffset">stroke-dashoffset</a></h2><p>stroke-dashoffset æŒ‡å®šäº† dash æ¨¡å¼åˆ°è·¯å¾„å¼€å§‹çš„è·ç¦»</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">baseProfile</span>=<span class="hljs-string">&quot;full&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100%&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 200, L200, 200, L400, 200&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-dashoffset</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br><br>## ç»“åˆdasharray ä¸ stroke-dashoffset è®©è·¯å¾„åŠ¨èµ·æ¥<br>```html<br><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">baseProfile</span>=<span class="hljs-string">&quot;full&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100%&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 200, L200, 200, L400, 200&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-dashoffset</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">animate</span> <span class="hljs-attr">attributeName</span>=<span class="hljs-string">&quot;stroke-dashoffset&quot;</span> <span class="hljs-attr">from</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;-20&quot;</span> <span class="hljs-attr">dur</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">&quot;freeze&quot;</span> <span class="hljs-attr">repeatCount</span>=<span class="hljs-string">&quot;indefinite&quot;</span> <span class="hljs-attr">easing</span>=<span class="hljs-string">&quot;linear&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">animate</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/svg/svg-1.gif"></p><h2 id="æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»"><a href="#æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»" class="headerlink" title="æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»"></a>æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»</h2><p>è¯¥åŠ¨ç”»éœ€è¦é€šè¿‡ SVGGeometryElementçš„ getTotalLength è·å–å…¨éƒ¨è·¯å¾„ï¼Œé€šè¿‡åŠ¨ç”»è®¾ç½®stroke-dashoffsetåç§»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;svg version=&quot;1.1&quot;<br>     baseProfile=&quot;full&quot;<br>     width=&quot;100%&quot; height=&quot;100%&quot;<br>     xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;<br>     &lt;path<br>        ref=&quot;pathEl2&quot;<br>        fill=&quot;none&quot;<br>        :stroke-dasharray=&quot;dashArray&quot;<br>        stroke=&quot;red&quot;<br>        stroke-width=&quot;6&quot;<br>            d=&quot;M 10,30<br>            A 20,20 0,0,1 50,30<br>            A 20,20 0,0,1 90,30<br>            Q 90,60 50,90<br>            Q 10,60 10,30 z&quot; &gt;<br>            &lt;!-- &lt;animate<br>                attributeName=&quot;dash&quot;<br>                values=&quot;0;5;0&quot;<br>                dur=&quot;10s&quot;<br>                repeatCount=&quot;indefinite&quot; /&gt; --&gt;<br>            &lt;/path&gt;<br><br>     &lt;path<br>        ref=&quot;pathEl&quot;<br>        fill=&quot;none&quot;<br>        :stroke-dasharray=&quot;dashArray&quot;<br>        :stroke-dashoffset=&quot;strokeDashoffset&quot;<br>        stroke-width=&quot;6&quot;<br>        stroke=&quot;green&quot;<br>            d=&quot;M 10,30<br>            A 20,20 0,0,1 50,30<br>            A 20,20 0,0,1 90,30<br>            Q 90,60 50,90<br>            Q 10,60 10,30 z&quot; &gt;<br>            &lt;animate<br>                attributeName=&quot;stroke-dashoffset&quot;<br>                from=&quot;275&quot;<br>                to=&quot;0&quot;<br>                dur=&quot;4s&quot;<br>                repeatCount=&quot;indefinite&quot; /&gt;<br>            &lt;/path&gt; <br>&lt;/svg&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;ts&quot;&gt;<br>import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;<br><br>const pathEl = ref&lt;SVGGeometryElement&gt;()<br><br>const dashArray = ref(275)<br>const strokeDashoffset = ref(-275)<br><br>onMounted(() =&gt; &#123;<br>    const totalLength = pathEl.value?.getTotalLength()<br>    console.log(totalLength)<br><br>&#125;)<br><br>&lt;/script&gt;<br><br>&lt;style scoped&gt;<br><br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œæ•ˆæœé¢„è§ˆ<br><img src="/img/svg/svg-path-wather.gif"></p><p>å…¶ä»–<br>TODO</p>]]></content>
    
    
    <categories>
      
      <category>SVG</category>
      
    </categories>
    
    
    <tags>
      
      <tag>svg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>svg åŠ¨ç”»</title>
    <link href="/2023/09/10/svg-animate/svg-animate/"/>
    <url>/2023/09/10/svg-animate/svg-animate/</url>
    
    <content type="html"><![CDATA[<h1 id="svg-åŠ¨ç”»"><a href="#svg-åŠ¨ç”»" class="headerlink" title="svg åŠ¨ç”»"></a>svg åŠ¨ç”»</h1><p><a href="https://css-tricks.com/guide-svg-animations-smil/">åŠ¨ç”»å‚è€ƒèµ„æ–™é“¾æ¥é“¾æ¥</a> <a href="https://css-tricks.com/guide-svg-animations-smil/">https://css-tricks.com/guide-svg-animations-smil/</a></p><h2 id="SVG-dasharray"><a href="#SVG-dasharray" class="headerlink" title="SVG dasharray"></a>SVG dasharray</h2><p>stroke-dasharray å±æ€§å¯ä»¥è®¾ç½®çº¿æ®µç»˜åˆ¶æ—¶çš„é—´éš”<br>stroke-dasharray æ•°å€¼å‹å€¼ å¯ä»¥é…ç½®2ä¸ªï¼Œç¬¬äºŒä¸ªå€¼ç¼ºçœ</p><ul><li>stroke-dasharray&#x3D;â€4â€ ä»£è¡¨dash å€¼å’Œoffseté—´è·ä¿æŒä¸€ç›´</li><li>stroke-dasharray&#x3D;â€4 5â€  dashå®½åº¦ä¸º4ï¼Œæ¯ä¸€å—é—´è·ä¸º5</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">baseProfile</span>=<span class="hljs-string">&quot;full&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100%&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 200, L200, 200, L400, 200&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h2 id="stroke-dashoffset"><a href="#stroke-dashoffset" class="headerlink" title="stroke-dashoffset"></a><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dashoffset">stroke-dashoffset</a></h2><p>stroke-dashoffset æŒ‡å®šäº† dash æ¨¡å¼åˆ°è·¯å¾„å¼€å§‹çš„è·ç¦»</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">baseProfile</span>=<span class="hljs-string">&quot;full&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100%&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 200, L200, 200, L400, 200&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-dashoffset</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br><br>## ç»“åˆdasharray ä¸ stroke-dashoffset è®©è·¯å¾„åŠ¨èµ·æ¥<br>```html<br><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">baseProfile</span>=<span class="hljs-string">&quot;full&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100%&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100%&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 200, L200, 200, L400, 200&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">&quot;M0, 250, L200, 250, L400, 250&quot;</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">&quot;green&quot;</span> <span class="hljs-attr">stroke-dasharray</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-dashoffset</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">animate</span> <span class="hljs-attr">attributeName</span>=<span class="hljs-string">&quot;stroke-dashoffset&quot;</span> <span class="hljs-attr">from</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;-20&quot;</span> <span class="hljs-attr">dur</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">&quot;freeze&quot;</span> <span class="hljs-attr">repeatCount</span>=<span class="hljs-string">&quot;indefinite&quot;</span> <span class="hljs-attr">easing</span>=<span class="hljs-string">&quot;linear&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">animate</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="/img/svg/svg-1.gif"></p><h2 id="æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»"><a href="#æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»" class="headerlink" title="æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»"></a>æ¨¡æ‹Ÿç®¡é“æ°´æµåŠ¨åŠ¨ç”»</h2><p>è¯¥åŠ¨ç”»éœ€è¦é€šè¿‡ SVGGeometryElementçš„ getTotalLength è·å–å…¨éƒ¨è·¯å¾„ï¼Œé€šè¿‡åŠ¨ç”»è®¾ç½®stroke-dashoffsetåç§»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;svg version=&quot;1.1&quot;<br>     baseProfile=&quot;full&quot;<br>     width=&quot;100%&quot; height=&quot;100%&quot;<br>     xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;<br>     &lt;path<br>        ref=&quot;pathEl2&quot;<br>        fill=&quot;none&quot;<br>        :stroke-dasharray=&quot;dashArray&quot;<br>        stroke=&quot;red&quot;<br>        stroke-width=&quot;6&quot;<br>            d=&quot;M 10,30<br>            A 20,20 0,0,1 50,30<br>            A 20,20 0,0,1 90,30<br>            Q 90,60 50,90<br>            Q 10,60 10,30 z&quot; &gt;<br>            &lt;!-- &lt;animate<br>                attributeName=&quot;dash&quot;<br>                values=&quot;0;5;0&quot;<br>                dur=&quot;10s&quot;<br>                repeatCount=&quot;indefinite&quot; /&gt; --&gt;<br>            &lt;/path&gt;<br><br>     &lt;path<br>        ref=&quot;pathEl&quot;<br>        fill=&quot;none&quot;<br>        :stroke-dasharray=&quot;dashArray&quot;<br>        :stroke-dashoffset=&quot;strokeDashoffset&quot;<br>        stroke-width=&quot;6&quot;<br>        stroke=&quot;green&quot;<br>            d=&quot;M 10,30<br>            A 20,20 0,0,1 50,30<br>            A 20,20 0,0,1 90,30<br>            Q 90,60 50,90<br>            Q 10,60 10,30 z&quot; &gt;<br>            &lt;animate<br>                attributeName=&quot;stroke-dashoffset&quot;<br>                from=&quot;275&quot;<br>                to=&quot;0&quot;<br>                dur=&quot;4s&quot;<br>                repeatCount=&quot;indefinite&quot; /&gt;<br>            &lt;/path&gt; <br>&lt;/svg&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&quot;ts&quot;&gt;<br>import &#123; onMounted, ref &#125; from &#x27;vue&#x27;;<br><br>const pathEl = ref&lt;SVGGeometryElement&gt;()<br><br>const dashArray = ref(275)<br>const strokeDashoffset = ref(-275)<br><br>onMounted(() =&gt; &#123;<br>    const totalLength = pathEl.value?.getTotalLength()<br>    console.log(totalLength)<br><br>&#125;)<br><br>&lt;/script&gt;<br><br>&lt;style scoped&gt;<br><br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œæ•ˆæœé¢„è§ˆ<br><img src="/img/svg/svg-path-wather.gif"></p><p>å…¶ä»–<br>TODO</p>]]></content>
    
    
    <categories>
      
      <category>SVG</category>
      
    </categories>
    
    
    <tags>
      
      <tag>svg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>inkscape</title>
    <link href="/2023/09/08/inkscape/"/>
    <url>/2023/09/08/inkscape/</url>
    
    <content type="html"><![CDATA[<h1 id="Inkscape-SVG-è‡ªç”±ç»˜å›¾å·¥å…·"><a href="#Inkscape-SVG-è‡ªç”±ç»˜å›¾å·¥å…·" class="headerlink" title="Inkscape SVG è‡ªç”±ç»˜å›¾å·¥å…·"></a><a href="https://inkscape.org/zh-hans/doc/tutorials/basic/tutorial-basic.html">Inkscape</a> SVG è‡ªç”±ç»˜å›¾å·¥å…·</h1><h2 id="è®¾ç½®æ–‡æ¡£å±æ€§"><a href="#è®¾ç½®æ–‡æ¡£å±æ€§" class="headerlink" title="è®¾ç½®æ–‡æ¡£å±æ€§"></a>è®¾ç½®æ–‡æ¡£å±æ€§</h2><p><img src="/img/inkscape/file-property.png"></p><h2 id="å•ä½è®¾ç½®"><a href="#å•ä½è®¾ç½®" class="headerlink" title="å•ä½è®¾ç½®"></a>å•ä½è®¾ç½®</h2><p><img src="/img/inkscape/file-property.png"></p><ol><li>å•ä½æŒ‰éœ€è®¾ç½®ï¼Œå¯é€‰px, mm ç­‰</li><li>ç”»å¸ƒå¤§å°æŒ‰éœ€è®¾ç½®å®½é«˜</li><li>è®¾ç½®å°ºå¯¸æ¯”ä¾‹ï¼Œæ­¤å¤„ä¼šå½±å“å¯¼å‡ºæœªsvg æ—¶çš„å¤§å°ï¼Œå»ºè®®é»˜è®¤è®¾ç½®ä¸º1</li></ol><h2 id="xml-å¿«é€Ÿç¼–è¾‘"><a href="#xml-å¿«é€Ÿç¼–è¾‘" class="headerlink" title="xml å¿«é€Ÿç¼–è¾‘"></a>xml å¿«é€Ÿç¼–è¾‘</h2><p><img src="/img/inkscape/xml-editor.png"></p><ul><li>é€šè¿‡å³ä¾§é…ç½®è“å¯ä»¥å¿«é€Ÿè·å–é¡µé¢ä¸ŠèŠ‚ç‚¹å±æ€§ä¿¡æ¯&amp;&amp; ç¼–è¾‘</li></ul><h2 id="å¯¼å‡ºæ–‡ä»¶"><a href="#å¯¼å‡ºæ–‡ä»¶" class="headerlink" title="å¯¼å‡ºæ–‡ä»¶"></a>å¯¼å‡ºæ–‡ä»¶</h2><p><img src="/img/inkscape/file-export.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>svg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>micro-app åŸºåº§åº”ç”¨å’Œå­åº”ç”¨å…±äº«window å…¨å±€å˜é‡</title>
    <link href="/2023/09/07/micro-deploy/micro-app_01/"/>
    <url>/2023/09/07/micro-deploy/micro-app_01/</url>
    
    <content type="html"><![CDATA[<p>micro-app è¿è¡Œæ—¶æ²™ç›’æœºåˆ¶ï¼Œä¼šå°†åŸºåº§åº”ç”¨window è‡ªå·±é…ç½®çš„å…¨å±€å˜é‡æ— æ³•å…±äº«<br>å…·ä½“å¯ä»¥å‚è€ƒ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * rewrite special properties of window</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> appName app name</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> microAppWindow child app microWindow</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">patchWindowProperty</span> (<br>  <span class="hljs-attr">microAppWindow</span>: microAppWindowType,<br>):<span class="hljs-built_in">void</span> &#123;<br>  <span class="hljs-keyword">const</span> rawWindow = globalEnv.<span class="hljs-property">rawWindow</span><br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(rawWindow)<br>    .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">key: <span class="hljs-built_in">string</span></span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^on/</span>.<span class="hljs-title function_">test</span>(key) &amp;&amp; !<span class="hljs-variable constant_">SCOPE_WINDOW_ON_EVENT</span>.<span class="hljs-title function_">includes</span>(key)<br>    &#125;)<br>    .<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">eventName: <span class="hljs-built_in">string</span></span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> &#123; enumerable, writable, set &#125; = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptor</span>(rawWindow, eventName) || &#123;<br>        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,<br>      &#125;<br>      <span class="hljs-title function_">rawDefineProperty</span>(microAppWindow, eventName, &#123;<br>        enumerable,<br>        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> rawWindow[eventName],<br>        <span class="hljs-attr">set</span>: writable ?? !!set<br>          ? <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123; rawWindow[eventName] = value &#125;<br>          : <span class="hljs-literal">undefined</span>,<br>      &#125;)<br>    &#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å¦‚æœåœ¨é¡¹ç›®ä¸­æƒ³é€šè¿‡å­åº”ç”¨ç›´æ¥è®¿é—® åŸºåº§åº”ç”¨windowä¸Šå±æ€§æœ‰ä¸¤ç§æ–¹æ¡ˆ<br>ä¾‹å¦‚åŸºåº§åº”ç”¨çš„windowå¯¹è±¡ä¸Šè‡ªå®šå½±äº† $name</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-variable language_">window</span>.<span class="hljs-property">$name</span> = <span class="hljs-string">&#x27;xxxxxx&#x27;</span><br></code></pre></td></tr></table></figure><ol><li>å­åº”ç”¨ä¸­é€šè¿‡window.rawWindow æ‹¿åˆ°åŸå§‹å¯¹è±¡</li></ol><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> name = <span class="hljs-variable language_">window</span>.<span class="hljs-property">rawWindow</span>.<span class="hljs-property">$name</span><br><br></code></pre></td></tr></table></figure><ol start="2"><li>é€šè¿‡micro-app çš„å†…ç½®çš„plugin å®šä¹‰å…¨å±€processHtml æ‹¦æˆªå¤„ç†, å°†å…±æœ‰å±æ€§é€šè¿‡ç«‹å³æ‰§è¡Œå‡½æ•°ç»™å­åº”ç”¨èµ‹å€¼ï¼Œè¾¾åˆ°åœ¨å­åº”ç”¨ä¸­ç›´æ¥é€šè¿‡window è·å–å¯¹åº”çš„å±æ€§<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-attr">plugins</span>: &#123;<br>     <span class="hljs-attr">global</span>: [<br>       &#123;<br>         <span class="hljs-attr">escapeProperties</span>: [],<br>         <span class="hljs-comment">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span><br>         <span class="hljs-title function_">processHtml</span>(<span class="hljs-params">code: <span class="hljs-built_in">string</span>, url: <span class="hljs-built_in">string</span></span>) &#123;<br>           <span class="hljs-comment">// å…¨å±€æ³¨å…¥ $YS å¯¹è±¡</span><br>           <span class="hljs-keyword">const</span> data = <span class="hljs-string">`&lt;head&gt;&lt;script&gt;(function(window) &#123;window.$name = window.rawWindow.$name&#125;)(window)&lt;/script&gt;`</span>;<br>           code = code.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;&lt;head&gt;&#x27;</span>, data);<br>           <span class="hljs-keyword">return</span> code;<br>         &#125;<br>       &#125;<br>     ],<br>     <span class="hljs-attr">modules</span>: &#123;&#125;<br>   &#125;<br></code></pre></td></tr></table></figure>å­åº”ç”¨å¯ä»¥é€šè¿‡ window.$name è·å–åˆ°å¯¹åº”çš„å€¼</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>å¾®å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>micro-app æ­å»ºè®°å½•</title>
    <link href="/2023/09/06/micro-deploy/micro-app/"/>
    <url>/2023/09/06/micro-deploy/micro-app/</url>
    
    <content type="html"><![CDATA[<h1 id="æ­å»ºå¹³å°åŸºåº§"><a href="#æ­å»ºå¹³å°åŸºåº§" class="headerlink" title="æ­å»ºå¹³å°åŸºåº§"></a>æ­å»ºå¹³å°åŸºåº§</h1><blockquote><p>åŸºåº§ä¸å¹³å°æ— å…³ï¼ŒæŠ€æœ¯æ ˆ vite + vue3 + element-plus<br><a href="https://zeroing.jd.com/micro-app/docs.html#/">micro-app v0.8.1</a><br><a href="https://micro-zoe.com/docs/1.x/#/zh-cn/start">micro-app 1.0.0-beta ç‰ˆæœ¬</a></p></blockquote><h2 id="é€šè¿‡vite-è„šæ‰‹æ¶æ­å»ºé¡¹ç›®"><a href="#é€šè¿‡vite-è„šæ‰‹æ¶æ­å»ºé¡¹ç›®" class="headerlink" title="é€šè¿‡vite è„šæ‰‹æ¶æ­å»ºé¡¹ç›®"></a>é€šè¿‡vite è„šæ‰‹æ¶æ­å»ºé¡¹ç›®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># npm 7+, extra double-dash is needed:</span><br>npm create vite@latest my-vue-app -- --template vue-ts<br><br></code></pre></td></tr></table></figure><ul><li><p>å®‰è£… micro-app </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i @micro-zoe/micro-app --save<br></code></pre></td></tr></table></figure></li><li><p>å…¥å£æ–‡ä»¶æ·»åŠ  <strong>micro-app</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"> <span class="hljs-keyword">import</span> microApp <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@micro-zoe/micro-app&#x27;</span>;<br> microApp.<span class="hljs-title function_">start</span>(&#123;<br>    <span class="hljs-attr">destroy</span>: <span class="hljs-literal">true</span><br> &#125;)<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>()<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#root&#x27;</span>)<br><br></code></pre></td></tr></table></figure></li></ul><h2 id="å®‰è£…element-plus"><a href="#å®‰è£…element-plus" class="headerlink" title="å®‰è£…element-plus"></a>å®‰è£…element-plus</h2><p>| ç”±äº micro-app åŸºåº§åº”ç”¨çš„æ ·å¼ç±»æ— æ³•è¢«éš”ç¦»ï¼Œå»ºè®®ä¿®æ”¹elment-plusæ ·å¼ç±»çš„å‘½åç©ºé—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i element-plus<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ element-plus å‘½åç©ºé—´<br>element plus å½“å‰å¯ä»¥å…¨å±€å¯¼å…¥ï¼Œå¦‚æœéœ€è¦æŒ‰éœ€å¯¼å…¥ä¿®æ”¹å‘½åç©ºé—´ å¯å‚è€ƒå®˜ç½‘</p><p><strong>è®¾ç½® ElConfigProvider</strong><br>ä½¿ç”¨ ElConfigProvider åŒ…è£…æ‚¨çš„æ ¹ç»„ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- App.vue --&gt;<br>&lt;template&gt;<br>  &lt;el-config-provider namespace=&quot;sk&quot;&gt;<br>    &lt;router-view&gt;&lt;/router-view&gt;<br>  &lt;/el-config-provider&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure><p><strong>è®¾ç½® SCSS å’Œ CSS å˜é‡</strong><br>åˆ›å»º styles&#x2F;element&#x2F;index.scssï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">// styles/element/index.scss</span><br><span class="hljs-comment">// we can add this to custom namespace, default is &#x27;el&#x27;</span><br><span class="hljs-keyword">@forward</span> <span class="hljs-string">&#x27;element-plus/theme-chalk/src/mixins/config.scss&#x27;</span> with (<br>  <span class="hljs-variable">$namespace</span>: <span class="hljs-string">&#x27;sk&#x27;</span><br>);<br><br><span class="hljs-keyword">@use</span> <span class="hljs-string">&quot;element-plus/theme-chalk/src/index.scss&quot;</span> as *;<br><span class="hljs-comment">// ...</span><br><br></code></pre></td></tr></table></figure><p>åœ¨ vite.config.ts ä¸­å¯¼å…¥ styles&#x2F;element&#x2F;index.scssï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-attr">css</span>: &#123;<br>    <span class="hljs-attr">preprocessorOptions</span>: &#123;<br>      <span class="hljs-attr">scss</span>: &#123;<br>        <span class="hljs-attr">additionalData</span>: <span class="hljs-string">`@use &quot;~/styles/element/index.scss&quot; as *;`</span>,<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// ...</span><br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="å­åº”ç”¨-vite-æŒ‚è½½"><a href="#å­åº”ç”¨-vite-æŒ‚è½½" class="headerlink" title="å­åº”ç”¨ vite æŒ‚è½½"></a>å­åº”ç”¨ vite æŒ‚è½½</h2><ul><li>æŒ‚è½½å­åº”ç”¨è·¯ç”±<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123;<br>  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">BASE_URL</span>),<br>  <span class="hljs-attr">routes</span>: [<br>    ...,<br>    &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/mse:*&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;mse&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/mse/index.vue&#x27;</span>),<br>    &#125;,<br>  ],<br>&#125;);<br><br></code></pre></td></tr></table></figure></li><li>viteå­åº”ç”¨ç»„ä»¶æŒ‚è½½<br>å­åº”ç”¨micro-app ä¸­éœ€è¦åŒºåˆ† URLä¸baseroute å…³ç³»å…·ä½“å¯<a href="https://zeroing.jd.com/micro-app/docs.html#/zh-cn/route">å‚è€ƒå®˜ç½‘</a><ul><li>URL ä¸ºè·å–index.htmlé™æ€èµ„æºçš„åŠ è½½è·¯ç”±</li><li>baseroute ä¸ºä¸‹å‘å­åº”ç”¨çš„åŒºåˆ†è·¯ç”±</li></ul></li></ul><h3 id="å…³é—­-disable-sandbox"><a href="#å…³é—­-disable-sandbox" class="headerlink" title="å…³é—­ disable-sandbox"></a>å…³é—­ disable-sandbox</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ts">&lt;template&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mse-iframe-container&quot;</span>&gt;</span></span><br><span class="language-xml">  // åŠ è½½vite åº”ç”¨éœ€è¦å…³é—­æ²™ç®±</span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">micro-app</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mse&quot;</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;http://localhost:8004&quot;</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;&#123;&#125;&quot;</span> <span class="hljs-attr">baseroute</span>=<span class="hljs-string">&quot;/child/vite-vue&quot;</span> <span class="hljs-attr">inline</span> <span class="hljs-attr">disablesandbox</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">micro-app</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">EventCenterForMicroApp</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@micro-zoe/micro-app&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> config, &#123; getAppUrl &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/micro-app/config.ts&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-comment">// @ts-ignore å› ä¸ºviteå­åº”ç”¨å…³é—­äº†æ²™ç®±ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå­åº”ç”¨mseåˆ›å»ºEventCenterForMicroAppå¯¹è±¡æ¥å®ç°æ•°æ®é€šä¿¡</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventCenterForMicroApp</span>(<span class="hljs-string">&#x27;mse&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;less&quot;</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.mse-iframe-container</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="Iframe-æ²™ç®±æ¨¡å¼åŠ è½½-BETA-1-0-å…¬æµ‹æ”¯æŒ"><a href="#Iframe-æ²™ç®±æ¨¡å¼åŠ è½½-BETA-1-0-å…¬æµ‹æ”¯æŒ" class="headerlink" title="Iframe æ²™ç®±æ¨¡å¼åŠ è½½(BETA 1.0 å…¬æµ‹æ”¯æŒ)"></a>Iframe æ²™ç®±æ¨¡å¼åŠ è½½(BETA 1.0 å…¬æµ‹æ”¯æŒ)</h3><blockquote><p>æ¨èä½¿ç”¨</p></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts">&lt;template&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">micro-app</span> <span class="hljs-attr">:name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">:url</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;data&quot;</span> <span class="hljs-attr">iframe</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">micro-app</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> config, &#123; getAppUrl &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/micro-app/config.ts&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; useMicroData &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/micro-app/micro-data-hooks&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> name = config.<span class="hljs-property">mse</span>.<span class="hljs-property">appName</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> url = <span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;http://localhost:9001&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> data = <span class="hljs-title function_">reactive</span>(&#123;&#125;)</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h1 id="vite-å­åº”ç”¨"><a href="#vite-å­åº”ç”¨" class="headerlink" title="vite å­åº”ç”¨"></a>vite å­åº”ç”¨</h1><blockquote><p>æŒ‰ç…§æ­£å¸¸æ–¹å¼æ­å»ºvite å­åº”ç”¨ï¼Œmain.ts &amp;&amp; serve æœåŠ¡éœ€è¦æ”¹é€ </p></blockquote><h2 id="å…³é—­-disable-sandbox-æ¨¡å¼-å­åº”ç”¨çš„-main-ts-é…ç½®"><a href="#å…³é—­-disable-sandbox-æ¨¡å¼-å­åº”ç”¨çš„-main-ts-é…ç½®" class="headerlink" title="å…³é—­ disable-sandbox æ¨¡å¼ å­åº”ç”¨çš„ main.ts é…ç½®"></a>å…³é—­ disable-sandbox æ¨¡å¼ å­åº”ç”¨çš„ main.ts é…ç½®</h2><h3 id="main-ts-å…¥å£æ–‡ä»¶æ–‡ä»¶"><a href="#main-ts-å…¥å£æ–‡ä»¶æ–‡ä»¶" class="headerlink" title="main.ts å…¥å£æ–‡ä»¶æ–‡ä»¶"></a>main.ts å…¥å£æ–‡ä»¶æ–‡ä»¶</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleMicroData</span> () &#123;<br>  <span class="hljs-comment">// eventCenterForAppNameVite æ˜¯åŸºåº§æ·»åŠ åˆ°windowçš„æ•°æ®é€šä¿¡å¯¹è±¡</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span>) &#123;<br>    <span class="hljs-comment">// ä¸»åŠ¨è·å–åŸºåº§ä¸‹å‘çš„æ•°æ®</span><br>    <span class="hljs-keyword">const</span> rootData = <span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span>.<span class="hljs-title function_">getData</span>()<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rootData)<br>  &#125;<br>&#125;<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br>app.<span class="hljs-title function_">use</span>(router);<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br><br><span class="hljs-title function_">handleMicroData</span>()<br><span class="hljs-comment">// ç›‘å¬å¸è½½æ“ä½œ</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;unmount&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  app.<span class="hljs-title function_">unmount</span>()<br>  <span class="hljs-comment">// å¸è½½æ‰€æœ‰æ•°æ®ç›‘å¬å‡½æ•°</span><br>  <span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span>?.<span class="hljs-title function_">clearDataListener</span>()<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="vite-config-ts-é…ç½®"><a href="#vite-config-ts-é…ç½®" class="headerlink" title="vite.config.ts é…ç½®"></a>vite.config.ts é…ç½®</h3><ul><li>server éœ€è¦æ”¯æŒ è·¨åŸŸè¯·æ±‚</li><li>æ‰“åŒ…æ—¶å¤„ç†<ul><li>æŒ‡å®šåŸŸåè®¾ç½®</li><li>é€šè¿‡åŠ¨æ€basePathæ’ä»¶ vite-plugin-dynamic-base  ç±»ä¼¼webpack __webpack_public_path__</li></ul></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; fileURLToPath, <span class="hljs-variable constant_">URL</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:url&#x27;</span><br><br><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span><br><span class="hljs-keyword">import</span> vueJsx <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span><br><span class="hljs-keyword">import</span> &#123; dynamicBase &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-dynamic-base&#x27;</span><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">base</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&quot;production&quot;</span> ? <span class="hljs-string">&quot;__dynamic_base__&quot;</span> : <span class="hljs-string">&quot;/child/vite-vue/&quot;</span>,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">vue</span>(),<br>    <span class="hljs-title function_">vueJsx</span>(),<br>    <span class="hljs-comment">//æ‰“åŒ…å </span><br>    <span class="hljs-title function_">dynamicBase</span>(&#123;<br>      <span class="hljs-attr">publicPath</span>: <span class="hljs-string">&#x27;window.__dynamic_base__&#x27;</span>,<br>      <span class="hljs-attr">transformIndexHtml</span>:  <span class="hljs-literal">true</span><br>    &#125;)<br>  ],<br>  <span class="hljs-attr">server</span>: &#123;<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">8004</span>,<br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>: <span class="hljs-string">&#x27;*&#x27;</span>,<br>    &#125;,<br>    <span class="hljs-attr">cors</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">alias</span>: &#123;<br>      <span class="hljs-string">&#x27;@&#x27;</span>: <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>))<br>    &#125;<br>  &#125;<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="ä¸»åº”ç”¨ä¸­éœ€è¦-micro-app-åŠ è½½æ—¶éœ€è¦plugins-éœ€è¦æ’ä»¶å¤„ç†"><a href="#ä¸»åº”ç”¨ä¸­éœ€è¦-micro-app-åŠ è½½æ—¶éœ€è¦plugins-éœ€è¦æ’ä»¶å¤„ç†" class="headerlink" title="ä¸»åº”ç”¨ä¸­éœ€è¦ micro-app åŠ è½½æ—¶éœ€è¦plugins éœ€è¦æ’ä»¶å¤„ç†"></a>ä¸»åº”ç”¨ä¸­éœ€è¦ micro-app åŠ è½½æ—¶éœ€è¦plugins éœ€è¦æ’ä»¶å¤„ç†</h3><p>å‚ç…§å®˜ç½‘ <a href="https://zeroing.jd.com/micro-app/docs.html#/zh-cn/framework/vite?id=%e4%bd%9c%e4%b8%ba%e5%9f%ba%e5%ba%a7%e5%ba%94%e7%94%a8">vite åŸºåº§é…ç½®</a></p><h2 id="Iframe-æ²™ç›’æ¨¡å¼ä¸‹é…ç½®"><a href="#Iframe-æ²™ç›’æ¨¡å¼ä¸‹é…ç½®" class="headerlink" title="Iframe æ²™ç›’æ¨¡å¼ä¸‹é…ç½®"></a>Iframe æ²™ç›’æ¨¡å¼ä¸‹é…ç½®</h2><h3 id="main-ts-é…ç½®"><a href="#main-ts-é…ç½®" class="headerlink" title="main.ts é…ç½®"></a>main.ts é…ç½®</h3><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// ä¸åŸºåº§è¿›è¡Œæ•°æ®äº¤äº’</span><br><span class="hljs-keyword">function</span> handle<span class="hljs-constructor">MicroData(<span class="hljs-params">router</span>: Router)</span> &#123;<br>  <span class="hljs-comment">// TODO ä»å…¨å±€è·å–æ•°æ®ï¼Œç­‰APP åº”ç”¨å®Œå…¨å·äº†åè§„åˆ’</span><br>  const rootData = window.microApp.get<span class="hljs-constructor">GlobalData()</span>;<br>  handle<span class="hljs-constructor">RootData(<span class="hljs-params">rootData</span>, <span class="hljs-params">router</span>)</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (is<span class="hljs-constructor">InMicroApp()</span>) &#123;<br>  handle<span class="hljs-constructor">MicroData(<span class="hljs-params">router</span>)</span>;<br>  <span class="hljs-comment">// å¸è½½åº”ç”¨</span><br>  window.unmount =<span class="hljs-function"> <span class="hljs-params">()</span> =&gt;</span> &#123;<br>    app.unmount<span class="hljs-literal">()</span>;<br>  &#125;;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="vite-config-ts-é…ç½®-1"><a href="#vite-config-ts-é…ç½®-1" class="headerlink" title="vite-config.ts é…ç½®"></a>vite-config.ts é…ç½®</h3><p>  <a href="https://micro-zoe.com/docs/1.x/#/zh-cn/framework/vite?id=%e4%bd%9c%e4%b8%ba%e5%ad%90%e5%ba%94%e7%94%a8">å‚è€ƒå®˜ç½‘</a></p><h1 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h1><p><a href="https://zeroing.jd.com/micro-app/docs.html#/zh-cn/deploy">å‚è€ƒå®˜ç½‘é…ç½®</a></p><h1 id="é—®é¢˜-è§£å†³æ–¹æ¡ˆ"><a href="#é—®é¢˜-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é—®é¢˜&amp;&amp;è§£å†³æ–¹æ¡ˆ"></a>é—®é¢˜&amp;&amp;è§£å†³æ–¹æ¡ˆ</h1><h2 id="0-8-1-ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite-å­åº”ç”¨"><a href="#0-8-1-ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite-å­åº”ç”¨" class="headerlink" title="0.8.1 ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite å­åº”ç”¨"></a>0.8.1 ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite å­åº”ç”¨</h2><ul><li><p>æ£€æŸ¥ window.__dynamic_base__ æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ</p><blockquote><p>å¯ä»¥åœ¨index.html é¡µé¢ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°æ¥åˆå§‹åŒ– __dynamic_base__ å˜é‡</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-property">__dynamic_base__</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">rawWindow__dynamic_base__</span> </span><br><span class="language-javascript">  &#125;)()</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>æ£€æŸ¥åŸºåº§æ˜¯å¦å¼€å¯vite å­åº”ç”¨çš„é¢„åŠ è½½</p><blockquote><p>åŸºåº§åº”ç”¨åŠ è½½ vite-vue å­åº”ç”¨æ—¶ä½¿ç”¨äº†é¢„åŠ è½½æ¨¡å¼ï¼Œé¢„åŠ è½½æ—¶ï¼Œå­åº”ç”¨çš„index.html å¼•ç”¨çš„js æ–‡ä»¶&amp;&amp; css æ–‡ä»¶åœ°å€ä¼šç›´æ¥è®¾ç½®æœªç›¸å¯¹åœ°å€ï¼ŒåŸºåº§ä¸­å…³é—­vite å­åº”ç”¨çš„é¢„åŠ è½½å³å¯</p></blockquote></li></ul><h2 id="çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“"><a href="#çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“" class="headerlink" title="çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“"></a>çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“</h2><ul><li>å¦‚æœåŸºåº§æ ·å¼åº“ä½¿ç”¨ elment-plus(2.2.0ç‰ˆæœ¬åŠä»¥ä¸Š) å¯ä»¥é€šè¿‡è‡ªå®šä¹‰å‘½åç©ºé—´è§„é¿æ±¡æŸ“</li><li>å¼€å¯æ²™ç›’æ¨¡å¼è¿›è¡Œæ ·å¼éš”ç¦»</li></ul><h2 id="iframe-æ²™ç®±ä¸‹-vite-å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯-cors-error"><a href="#iframe-æ²™ç®±ä¸‹-vite-å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯-cors-error" class="headerlink" title="iframe æ²™ç®±ä¸‹ vite å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯ cors-error"></a>iframe æ²™ç®±ä¸‹ vite å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯ cors-error</h2><p><img src="/img/micro-app/cors-error.png"></p><p>åŸå› å¯èƒ½åœ¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials">MDN COROS policy</a></p><ol><li>vite å­åº”ç”¨ axios withCredentials è®¾ç½®ä¸ºfalse</li><li>baseUrl å»ºè®®è®¾ç½®å’Œçˆ¶çº§åŒå±‚çš„URL</li></ol><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> basepath = <span class="hljs-string">&#x27;/xxxx&#x27;</span><br><span class="hljs-keyword">const</span> http = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">__MICRO_APP_ENVIRONMENT__</span> ? <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span> + basepath :  basepath,<br>  <span class="hljs-attr">withCredentials</span>: !<span class="hljs-variable language_">window</span>.<span class="hljs-property">__MICRO_APP_ENVIRONMENT__</span>,<br>&#125;)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å¾®å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>micro-app æ­å»ºè®°å½•</title>
    <link href="/2023/09/06/micro-web/micro-app/"/>
    <url>/2023/09/06/micro-web/micro-app/</url>
    
    <content type="html"><![CDATA[<h1 id="æ­å»ºå¹³å°åŸºåº§"><a href="#æ­å»ºå¹³å°åŸºåº§" class="headerlink" title="æ­å»ºå¹³å°åŸºåº§"></a>æ­å»ºå¹³å°åŸºåº§</h1><blockquote><p>åŸºåº§ä¸å¹³å°æ— å…³ï¼ŒæŠ€æœ¯æ ˆ vite + vue3 + element-plus<br><a href="https://zeroing.jd.com/micro-app/docs.html#/">micro-app v0.8.1</a><br><a href="https://micro-zoe.com/docs/1.x/#/zh-cn/start">micro-app 1.0.0-beta ç‰ˆæœ¬</a></p></blockquote><h2 id="é€šè¿‡vite-è„šæ‰‹æ¶æ­å»ºé¡¹ç›®"><a href="#é€šè¿‡vite-è„šæ‰‹æ¶æ­å»ºé¡¹ç›®" class="headerlink" title="é€šè¿‡vite è„šæ‰‹æ¶æ­å»ºé¡¹ç›®"></a>é€šè¿‡vite è„šæ‰‹æ¶æ­å»ºé¡¹ç›®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># npm 7+, extra double-dash is needed:</span><br>npm create vite@latest my-vue-app -- --template vue-ts<br><br></code></pre></td></tr></table></figure><ul><li><p>å®‰è£… micro-app </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i @micro-zoe/micro-app --save<br></code></pre></td></tr></table></figure></li><li><p>å…¥å£æ–‡ä»¶æ·»åŠ  <strong>micro-app</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"> <span class="hljs-keyword">import</span> microApp <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@micro-zoe/micro-app&#x27;</span>;<br> microApp.<span class="hljs-title function_">start</span>(&#123;<br>    <span class="hljs-attr">destroy</span>: <span class="hljs-literal">true</span><br> &#125;)<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>()<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#root&#x27;</span>)<br><br></code></pre></td></tr></table></figure></li></ul><h2 id="å®‰è£…element-plus"><a href="#å®‰è£…element-plus" class="headerlink" title="å®‰è£…element-plus"></a>å®‰è£…element-plus</h2><p>| ç”±äº micro-app åŸºåº§åº”ç”¨çš„æ ·å¼ç±»æ— æ³•è¢«éš”ç¦»ï¼Œå»ºè®®ä¿®æ”¹elment-plusæ ·å¼ç±»çš„å‘½åç©ºé—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i element-plus<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ element-plus å‘½åç©ºé—´<br>element plus å½“å‰å¯ä»¥å…¨å±€å¯¼å…¥ï¼Œå¦‚æœéœ€è¦æŒ‰éœ€å¯¼å…¥ä¿®æ”¹å‘½åç©ºé—´ å¯å‚è€ƒå®˜ç½‘</p><p><strong>è®¾ç½® ElConfigProvider</strong><br>ä½¿ç”¨ ElConfigProvider åŒ…è£…æ‚¨çš„æ ¹ç»„ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- App.vue --&gt;<br>&lt;template&gt;<br>  &lt;el-config-provider namespace=&quot;sk&quot;&gt;<br>    &lt;router-view&gt;&lt;/router-view&gt;<br>  &lt;/el-config-provider&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure><p><strong>è®¾ç½® SCSS å’Œ CSS å˜é‡</strong><br>åˆ›å»º styles&#x2F;element&#x2F;index.scssï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">// styles/element/index.scss</span><br><span class="hljs-comment">// we can add this to custom namespace, default is &#x27;el&#x27;</span><br><span class="hljs-keyword">@forward</span> <span class="hljs-string">&#x27;element-plus/theme-chalk/src/mixins/config.scss&#x27;</span> with (<br>  <span class="hljs-variable">$namespace</span>: <span class="hljs-string">&#x27;sk&#x27;</span><br>);<br><br><span class="hljs-keyword">@use</span> <span class="hljs-string">&quot;element-plus/theme-chalk/src/index.scss&quot;</span> as *;<br><span class="hljs-comment">// ...</span><br><br></code></pre></td></tr></table></figure><p>åœ¨ vite.config.ts ä¸­å¯¼å…¥ styles&#x2F;element&#x2F;index.scssï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-attr">css</span>: &#123;<br>    <span class="hljs-attr">preprocessorOptions</span>: &#123;<br>      <span class="hljs-attr">scss</span>: &#123;<br>        <span class="hljs-attr">additionalData</span>: <span class="hljs-string">`@use &quot;~/styles/element/index.scss&quot; as *;`</span>,<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// ...</span><br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="å­åº”ç”¨-vite-æŒ‚è½½"><a href="#å­åº”ç”¨-vite-æŒ‚è½½" class="headerlink" title="å­åº”ç”¨ vite æŒ‚è½½"></a>å­åº”ç”¨ vite æŒ‚è½½</h2><ul><li>æŒ‚è½½å­åº”ç”¨è·¯ç”±<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123;<br>  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">BASE_URL</span>),<br>  <span class="hljs-attr">routes</span>: [<br>    ...,<br>    &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/mse:*&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;mse&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/mse/index.vue&#x27;</span>),<br>    &#125;,<br>  ],<br>&#125;);<br><br></code></pre></td></tr></table></figure></li><li>viteå­åº”ç”¨ç»„ä»¶æŒ‚è½½<br>å­åº”ç”¨micro-app ä¸­éœ€è¦åŒºåˆ† URLä¸baseroute å…³ç³»å…·ä½“å¯<a href="https://zeroing.jd.com/micro-app/docs.html#/zh-cn/route">å‚è€ƒå®˜ç½‘</a><ul><li>URL ä¸ºè·å–index.htmlé™æ€èµ„æºçš„åŠ è½½è·¯ç”±</li><li>baseroute ä¸ºä¸‹å‘å­åº”ç”¨çš„åŒºåˆ†è·¯ç”±</li></ul></li></ul><h3 id="å…³é—­-disable-sandbox"><a href="#å…³é—­-disable-sandbox" class="headerlink" title="å…³é—­ disable-sandbox"></a>å…³é—­ disable-sandbox</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ts">&lt;template&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mse-iframe-container&quot;</span>&gt;</span></span><br><span class="language-xml">  // åŠ è½½vite åº”ç”¨éœ€è¦å…³é—­æ²™ç®±</span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">micro-app</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mse&quot;</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;http://localhost:8004&quot;</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;&#123;&#125;&quot;</span> <span class="hljs-attr">baseroute</span>=<span class="hljs-string">&quot;/child/vite-vue&quot;</span> <span class="hljs-attr">inline</span> <span class="hljs-attr">disablesandbox</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">micro-app</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">EventCenterForMicroApp</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@micro-zoe/micro-app&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> config, &#123; getAppUrl &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/micro-app/config.ts&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-comment">// @ts-ignore å› ä¸ºviteå­åº”ç”¨å…³é—­äº†æ²™ç®±ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå­åº”ç”¨mseåˆ›å»ºEventCenterForMicroAppå¯¹è±¡æ¥å®ç°æ•°æ®é€šä¿¡</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventCenterForMicroApp</span>(<span class="hljs-string">&#x27;mse&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;less&quot;</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.mse-iframe-container</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="Iframe-æ²™ç®±æ¨¡å¼åŠ è½½-BETA-1-0-å…¬æµ‹æ”¯æŒ"><a href="#Iframe-æ²™ç®±æ¨¡å¼åŠ è½½-BETA-1-0-å…¬æµ‹æ”¯æŒ" class="headerlink" title="Iframe æ²™ç®±æ¨¡å¼åŠ è½½(BETA 1.0 å…¬æµ‹æ”¯æŒ)"></a>Iframe æ²™ç®±æ¨¡å¼åŠ è½½(BETA 1.0 å…¬æµ‹æ”¯æŒ)</h3><blockquote><p>æ¨èä½¿ç”¨</p></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts">&lt;template&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">micro-app</span> <span class="hljs-attr">:name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">:url</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;data&quot;</span> <span class="hljs-attr">iframe</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">micro-app</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> config, &#123; getAppUrl &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/micro-app/config.ts&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; useMicroData &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/micro-app/micro-data-hooks&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> name = config.<span class="hljs-property">mse</span>.<span class="hljs-property">appName</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> url = <span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;http://localhost:9001&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> data = <span class="hljs-title function_">reactive</span>(&#123;&#125;)</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h1 id="vite-å­åº”ç”¨"><a href="#vite-å­åº”ç”¨" class="headerlink" title="vite å­åº”ç”¨"></a>vite å­åº”ç”¨</h1><blockquote><p>æŒ‰ç…§æ­£å¸¸æ–¹å¼æ­å»ºvite å­åº”ç”¨ï¼Œmain.ts &amp;&amp; serve æœåŠ¡éœ€è¦æ”¹é€ </p></blockquote><h2 id="å…³é—­-disable-sandbox-æ¨¡å¼-å­åº”ç”¨çš„-main-ts-é…ç½®"><a href="#å…³é—­-disable-sandbox-æ¨¡å¼-å­åº”ç”¨çš„-main-ts-é…ç½®" class="headerlink" title="å…³é—­ disable-sandbox æ¨¡å¼ å­åº”ç”¨çš„ main.ts é…ç½®"></a>å…³é—­ disable-sandbox æ¨¡å¼ å­åº”ç”¨çš„ main.ts é…ç½®</h2><h3 id="main-ts-å…¥å£æ–‡ä»¶æ–‡ä»¶"><a href="#main-ts-å…¥å£æ–‡ä»¶æ–‡ä»¶" class="headerlink" title="main.ts å…¥å£æ–‡ä»¶æ–‡ä»¶"></a>main.ts å…¥å£æ–‡ä»¶æ–‡ä»¶</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleMicroData</span> () &#123;<br>  <span class="hljs-comment">// eventCenterForAppNameVite æ˜¯åŸºåº§æ·»åŠ åˆ°windowçš„æ•°æ®é€šä¿¡å¯¹è±¡</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span>) &#123;<br>    <span class="hljs-comment">// ä¸»åŠ¨è·å–åŸºåº§ä¸‹å‘çš„æ•°æ®</span><br>    <span class="hljs-keyword">const</span> rootData = <span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span>.<span class="hljs-title function_">getData</span>()<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rootData)<br>  &#125;<br>&#125;<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br>app.<span class="hljs-title function_">use</span>(router);<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br><br><span class="hljs-title function_">handleMicroData</span>()<br><span class="hljs-comment">// ç›‘å¬å¸è½½æ“ä½œ</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;unmount&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  app.<span class="hljs-title function_">unmount</span>()<br>  <span class="hljs-comment">// å¸è½½æ‰€æœ‰æ•°æ®ç›‘å¬å‡½æ•°</span><br>  <span class="hljs-variable language_">window</span>.<span class="hljs-property">eventCenterForAppNameVite</span>?.<span class="hljs-title function_">clearDataListener</span>()<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="vite-config-ts-é…ç½®"><a href="#vite-config-ts-é…ç½®" class="headerlink" title="vite.config.ts é…ç½®"></a>vite.config.ts é…ç½®</h3><ul><li>server éœ€è¦æ”¯æŒ è·¨åŸŸè¯·æ±‚</li><li>æ‰“åŒ…æ—¶å¤„ç†<ul><li>æŒ‡å®šåŸŸåè®¾ç½®</li><li>é€šè¿‡åŠ¨æ€basePathæ’ä»¶ vite-plugin-dynamic-base  ç±»ä¼¼webpack __webpack_public_path__</li></ul></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; fileURLToPath, <span class="hljs-variable constant_">URL</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:url&#x27;</span><br><br><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span><br><span class="hljs-keyword">import</span> vueJsx <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span><br><span class="hljs-keyword">import</span> &#123; dynamicBase &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite-plugin-dynamic-base&#x27;</span><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">base</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&quot;production&quot;</span> ? <span class="hljs-string">&quot;__dynamic_base__&quot;</span> : <span class="hljs-string">&quot;/child/vite-vue/&quot;</span>,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">vue</span>(),<br>    <span class="hljs-title function_">vueJsx</span>(),<br>    <span class="hljs-comment">//æ‰“åŒ…å </span><br>    <span class="hljs-title function_">dynamicBase</span>(&#123;<br>      <span class="hljs-attr">publicPath</span>: <span class="hljs-string">&#x27;window.__dynamic_base__&#x27;</span>,<br>      <span class="hljs-attr">transformIndexHtml</span>:  <span class="hljs-literal">true</span><br>    &#125;)<br>  ],<br>  <span class="hljs-attr">server</span>: &#123;<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">8004</span>,<br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>: <span class="hljs-string">&#x27;*&#x27;</span>,<br>    &#125;,<br>    <span class="hljs-attr">cors</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">alias</span>: &#123;<br>      <span class="hljs-string">&#x27;@&#x27;</span>: <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">&#x27;./src&#x27;</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>))<br>    &#125;<br>  &#125;<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="ä¸»åº”ç”¨ä¸­éœ€è¦-micro-app-åŠ è½½æ—¶éœ€è¦plugins-éœ€è¦æ’ä»¶å¤„ç†"><a href="#ä¸»åº”ç”¨ä¸­éœ€è¦-micro-app-åŠ è½½æ—¶éœ€è¦plugins-éœ€è¦æ’ä»¶å¤„ç†" class="headerlink" title="ä¸»åº”ç”¨ä¸­éœ€è¦ micro-app åŠ è½½æ—¶éœ€è¦plugins éœ€è¦æ’ä»¶å¤„ç†"></a>ä¸»åº”ç”¨ä¸­éœ€è¦ micro-app åŠ è½½æ—¶éœ€è¦plugins éœ€è¦æ’ä»¶å¤„ç†</h3><p>å‚ç…§å®˜ç½‘ <a href="https://zeroing.jd.com/micro-app/docs.html#/zh-cn/framework/vite?id=%e4%bd%9c%e4%b8%ba%e5%9f%ba%e5%ba%a7%e5%ba%94%e7%94%a8">vite åŸºåº§é…ç½®</a></p><h2 id="Iframe-æ²™ç›’æ¨¡å¼ä¸‹é…ç½®"><a href="#Iframe-æ²™ç›’æ¨¡å¼ä¸‹é…ç½®" class="headerlink" title="Iframe æ²™ç›’æ¨¡å¼ä¸‹é…ç½®"></a>Iframe æ²™ç›’æ¨¡å¼ä¸‹é…ç½®</h2><h3 id="main-ts-é…ç½®"><a href="#main-ts-é…ç½®" class="headerlink" title="main.ts é…ç½®"></a>main.ts é…ç½®</h3><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// ä¸åŸºåº§è¿›è¡Œæ•°æ®äº¤äº’</span><br><span class="hljs-keyword">function</span> handle<span class="hljs-constructor">MicroData(<span class="hljs-params">router</span>: Router)</span> &#123;<br>  <span class="hljs-comment">// TODO ä»å…¨å±€è·å–æ•°æ®ï¼Œç­‰APP åº”ç”¨å®Œå…¨å·äº†åè§„åˆ’</span><br>  const rootData = window.microApp.get<span class="hljs-constructor">GlobalData()</span>;<br>  handle<span class="hljs-constructor">RootData(<span class="hljs-params">rootData</span>, <span class="hljs-params">router</span>)</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (is<span class="hljs-constructor">InMicroApp()</span>) &#123;<br>  handle<span class="hljs-constructor">MicroData(<span class="hljs-params">router</span>)</span>;<br>  <span class="hljs-comment">// å¸è½½åº”ç”¨</span><br>  window.unmount =<span class="hljs-function"> <span class="hljs-params">()</span> =&gt;</span> &#123;<br>    app.unmount<span class="hljs-literal">()</span>;<br>  &#125;;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="vite-config-ts-é…ç½®-1"><a href="#vite-config-ts-é…ç½®-1" class="headerlink" title="vite-config.ts é…ç½®"></a>vite-config.ts é…ç½®</h3><p>  <a href="https://micro-zoe.com/docs/1.x/#/zh-cn/framework/vite?id=%e4%bd%9c%e4%b8%ba%e5%ad%90%e5%ba%94%e7%94%a8">å‚è€ƒå®˜ç½‘</a></p><h1 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h1><p><a href="https://zeroing.jd.com/micro-app/docs.html#/zh-cn/deploy">å‚è€ƒå®˜ç½‘é…ç½®</a></p><h1 id="é—®é¢˜-è§£å†³æ–¹æ¡ˆ"><a href="#é—®é¢˜-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é—®é¢˜&amp;&amp;è§£å†³æ–¹æ¡ˆ"></a>é—®é¢˜&amp;&amp;è§£å†³æ–¹æ¡ˆ</h1><h2 id="0-8-1-ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite-å­åº”ç”¨"><a href="#0-8-1-ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite-å­åº”ç”¨" class="headerlink" title="0.8.1 ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite å­åº”ç”¨"></a>0.8.1 ç‰ˆæœ¬ä¸­éƒ¨ç½²åæ— æ³•åŠ è½½vite å­åº”ç”¨</h2><ul><li><p>æ£€æŸ¥ window.__dynamic_base__ æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ</p><blockquote><p>å¯ä»¥åœ¨index.html é¡µé¢ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°æ¥åˆå§‹åŒ– __dynamic_base__ å˜é‡</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-property">__dynamic_base__</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">rawWindow__dynamic_base__</span> </span><br><span class="language-javascript">  &#125;)()</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>æ£€æŸ¥åŸºåº§æ˜¯å¦å¼€å¯vite å­åº”ç”¨çš„é¢„åŠ è½½</p><blockquote><p>åŸºåº§åº”ç”¨åŠ è½½ vite-vue å­åº”ç”¨æ—¶ä½¿ç”¨äº†é¢„åŠ è½½æ¨¡å¼ï¼Œé¢„åŠ è½½æ—¶ï¼Œå­åº”ç”¨çš„index.html å¼•ç”¨çš„js æ–‡ä»¶&amp;&amp; css æ–‡ä»¶åœ°å€ä¼šç›´æ¥è®¾ç½®æœªç›¸å¯¹åœ°å€ï¼ŒåŸºåº§ä¸­å…³é—­vite å­åº”ç”¨çš„é¢„åŠ è½½å³å¯</p></blockquote></li></ul><h2 id="çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“"><a href="#çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“" class="headerlink" title="çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“"></a>çˆ¶å­èµ„æºæ ·å¼ç›¸äº’æ±¡æŸ“</h2><ul><li>å¦‚æœåŸºåº§æ ·å¼åº“ä½¿ç”¨ elment-plus(2.2.0ç‰ˆæœ¬åŠä»¥ä¸Š) å¯ä»¥é€šè¿‡è‡ªå®šä¹‰å‘½åç©ºé—´è§„é¿æ±¡æŸ“</li><li>å¼€å¯æ²™ç›’æ¨¡å¼è¿›è¡Œæ ·å¼éš”ç¦»</li></ul><h2 id="iframe-æ²™ç®±ä¸‹-vite-å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯-cors-error"><a href="#iframe-æ²™ç®±ä¸‹-vite-å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯-cors-error" class="headerlink" title="iframe æ²™ç®±ä¸‹ vite å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯ cors-error"></a>iframe æ²™ç®±ä¸‹ vite å­åº”ç”¨çš„æ¥å£è¯·æ±‚æ€»æ˜¯ cors-error</h2><p><img src="/img/micro-app/cors-error.png"></p><p>åŸå› å¯èƒ½åœ¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials">MDN COROS policy</a></p><ol><li>vite å­åº”ç”¨ axios withCredentials è®¾ç½®ä¸ºfalse</li><li>baseUrl å»ºè®®è®¾ç½®å’Œçˆ¶çº§åŒå±‚çš„URL</li></ol><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> basepath = <span class="hljs-string">&#x27;/xxxx&#x27;</span><br><span class="hljs-keyword">const</span> http = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">__MICRO_APP_ENVIRONMENT__</span> ? <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span> + basepath :  basepath,<br>  <span class="hljs-attr">withCredentials</span>: !<span class="hljs-variable language_">window</span>.<span class="hljs-property">__MICRO_APP_ENVIRONMENT__</span>,<br>&#125;)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å¾®å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
